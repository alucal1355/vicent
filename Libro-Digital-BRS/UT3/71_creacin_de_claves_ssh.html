<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="es" xml:lang="es" xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>7.1 Creación de claves SSH | UT3. Sistemas de control de acceso y credenciales </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta http-equiv="content-language" content="es" />
<meta name="author" content="Juan Carlos Requena" />
<link rel="license" type="text/html" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" />
<meta name="generator" content="eXeLearning 2.7 - exelearning.net" />
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body class="exe-web-site" id="exe-node-106"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Saltar la navegación</a></p>
<div id="header"  style="background-image: url(logoJCRequena.png); background-repeat: no-repeat;"><div id="headerContent">UT3. Sistemas de control de acceso y credenciales</div></div>
<div id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">UT3. Sistemas de control de acceso y credenciales</a></li>
   <li><a href="objetivos.html" class="no-ch">Objetivos</a></li>
   <li><a href="recomendaciones_de_estudio__resumen.html" class="no-ch">Recomendaciones de estudio - Resumen</a></li>
   <li><a href="1_mecanismos_de_autenticacin_tipos_de_factores.html" class="daddy">1. Mecanismos de autenticación. Tipos de factores.</a>
   <ul class="other-section">
      <li><a href="11_mltiples_factores_de_autenticacin.html" class="no-ch">1.1 Múltiples factores de autenticación</a></li>
      <li><a href="tarea_1_autenticacin_de_doble_factor_por_ssh_con_google_authenticator.html" class="no-ch">Tarea 1. Autenticación de doble factor por SSH con Google Authenticator</a></li>
      <li><a href="laboratorio_1_autenticacin_multifactor_con_yubico.html" class="no-ch">Laboratorio 1. Autenticación multifactor con Yubico</a></li>
      <li><a href="tarea_2_ubuntu__2fa_para_login_con_yubico_security_key.html" class="no-ch">Tarea 2. Ubuntu - 2FA para login con Yubico Security Key</a></li>
   </ul>
   </li>
   <li><a href="2_tcnicas_de_autenticacin.html" class="no-ch">2. Técnicas de autenticación</a></li>
   <li><a href="3_gestin_de_credenciales.html" class="daddy">3. Gestión de credenciales</a>
   <ul class="other-section">
      <li><a href="31_lastpass.html" class="no-ch">3.1 LastPass</a></li>
      <li><a href="32_keepass.html" class="no-ch">3.2 Keepass</a></li>
      <li><a href="33_otros_gestores_de_contraseas.html" class="no-ch">3.3 Otros gestores de contraseñas</a></li>
      <li><a href="tarea_3_instalacin_configuracin_y_puesta_en_produccin_de_un_gestor_de_credenciales.html" class="no-ch">Tarea 3. Instalación, configuración y puesta en producción de un gestor de credenciales</a></li>
      <li><a href="34_brechas_de_seguridad_y_contraseas_inseguras.html" class="no-ch">3.4 Brechas de seguridad y contraseñas inseguras</a></li>
   </ul>
   </li>
   <li><a href="4_acceso_por_medio_de_firma_electrnica.html" class="daddy">4. Acceso por medio de firma electrónica</a>
   <ul class="other-section">
      <li><a href="41_lectores_de_dnie.html" class="no-ch">4.1 Lectores de DNIe</a></li>
      <li><a href="42_uso_de_nfc_con_el_dnie.html" class="no-ch">4.2 Uso de NFC con el DNIe</a></li>
   </ul>
   </li>
   <li><a href="5_sistemas_de_single_sign_on_sso.html" class="daddy">5. Sistemas de Single Sign On SSO</a>
   <ul class="other-section">
      <li><a href="tarea_4_sistemas_sso.html" class="no-ch">Tarea 4. Sistemas SSO</a></li>
   </ul>
   </li>
   <li><a href="6_criptografa.html" class="daddy">6. Criptografía</a>
   <ul class="other-section">
      <li><a href="61_aplicacin_de_la_criptografa_en_la_seguridad_de_la_informacin.html" class="daddy">6.1 Aplicación de la Criptografía en la seguridad de la información</a>
      <ul class="other-section">
         <li><a href="611_principios_bsicos_de_la_criptografa.html" class="no-ch">6.1.1 Principios básicos de la criptografía</a></li>
         <li><a href="612_criptografa_clsica.html" class="no-ch">6.1.2 Criptografía clásica</a></li>
         <li><a href="613_servicios_de_seguridad_de_criptografa.html" class="no-ch">6.1.3 Servicios de seguridad de criptografía</a></li>
         <li><a href="614_criptografa_moderna.html" class="daddy">6.1.4 Criptografía Moderna</a>
         <ul class="other-section">
            <li><a href="6141_criptografa_de_clave_privada.html" class="daddy">6.1.4.1 Criptografía de clave privada</a>
            <ul class="other-section">
               <li><a href="laboratorio_1_cifrado_simtrico_de_archivos.html" class="no-ch">Laboratorio 1. Cifrado simétrico de archivos</a></li>
               <li><a href="prctica_1_cifrado_simtrico.html" class="no-ch">Práctica 1. Cifrado simétrico</a></li>
            </ul>
            </li>
            <li><a href="6142_criptografa_de_clave_pblica.html" class="daddy">6.1.4.2 Criptografía de clave pública</a>
            <ul class="other-section">
               <li><a href="laboratorio_2_cifrado_asimtrico_de_ficheros.html" class="no-ch">Laboratorio 2. Cifrado asimétrico de ficheros</a></li>
               <li><a href="prctica_2cifrado_asimtrico.html" class="no-ch">Práctica 2.Cifrado Asimétrico</a></li>
            </ul>
            </li>
            <li><a href="6143_ventas_y_desventajas_cifrado_simtrico_y_asimetrico.html" class="no-ch">6.1.4.3 Ventas y desventajas cifrado simétrico y asimetrico</a></li>
            <li><a href="6144_criptografa_hbirida.html" class="no-ch">6.1.4.4 Criptografía híbirida</a></li>
         </ul>
         </li>
         <li><a href="615_esteganografa.html" class="daddy">6.1.5 Esteganografía</a>
         <ul class="other-section">
            <li><a href="tarea_5_openstego.html" class="no-ch">Tarea 5. OpenStego</a></li>
         </ul>
         </li>
         <li><a href="616_funciones_hash.html" class="daddy">6.1.6 Funciones hash</a>
         <ul class="other-section">
            <li><a href="tarea_6_funciones_hash.html" class="no-ch">Tarea 6. Funciones hash</a></li>
            <li><a href="tarea_7_quickhash.html" class="no-ch">Tarea 7. QuickHash</a></li>
            <li><a href="tarea_8_funciones_avanzadas_hash_de_powershell.html" class="no-ch">Tarea 8. Funciones avanzadas hash de powershell</a></li>
            <li><a href="laboratorio_3_funciones_hash_con_kleopatra.html" class="no-ch">Laboratorio 3. Funciones hash con Kleopatra</a></li>
         </ul>
         </li>
         <li><a href="617_uso_de_tcnicas_criptogrficas_en_las_pyme.html" class="no-ch">6.1.7 Uso de técnicas criptográficas en las PYME</a></li>
         <li><a href="618_sistemas_encriptacin_hardware_tpmhsm.html" class="no-ch">6.1.8 Sistemas encriptación hardware (TPM/HSM)</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li class="current-page-parent"><a href="7_sistemas_de_control_de_acceso_y_autenticacin.html" class="current-page-parent daddy">7. Sistemas de control de acceso y autenticación</a>
   <ul>
      <li id="active"><a href="71_creacin_de_claves_ssh.html" class="active no-ch">7.1 Creación de claves SSH</a></li>
      <li><a href="72_certificados_digitales_gestin_de_una_pki.html" class="daddy">7.2. Certificados digitales, gestión de una PKI</a>
      <ul class="other-section">
         <li><a href="721_certificados_digitales.html" class="daddy">7.2.1 Certificados digitales</a>
         <ul class="other-section">
            <li><a href="laboratorio_4_certificado_personal.html" class="no-ch">Laboratorio 4. Certificado personal</a></li>
            <li><a href="tarea_9_verificacin_de_certificados_digitales.html" class="no-ch">Tarea 9. Verificación de certificados digitales</a></li>
         </ul>
         </li>
         <li><a href="722_firma_digital.html" class="daddy">7.2.2 Firma digital</a>
         <ul class="other-section">
            <li><a href="prctica_3_verificacin_de_la_autenticidad_e_integridad_de_un_mensaje.html" class="no-ch">Práctica 3: Verificación de la autenticidad e integridad de un mensaje</a></li>
         </ul>
         </li>
         <li><a href="723_infraestructuras_de_clave_pblica_pki.html" class="no-ch">7.2.3 Infraestructuras de clave pública (PKI)</a></li>
         <li><a href="laboratorio_5_infraestructura_de_clave_pblica_propia_con_openssl.html" class="no-ch">Laboratorio 5. Infraestructura de clave pública propia con OpenSSL</a></li>
         <li><a href="caso_prctico_uso_de_certificados_en_servicios_web.html" class="no-ch">Caso Práctico. Uso de certificados en Servicios WEB</a></li>
         <li><a href="reto_implementacin_de_una_sistema_de_certificados_pki_en_la_organizacin_con_easyrsa.html" class="no-ch">Reto. Implementación de una sistema de certificados (PKI) en la organización con Easy-RSA</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="8_gestin_de_accesos_sistemas_nac.html" class="daddy">8. Gestión de accesos. Sistemas NAC</a>
   <ul class="other-section">
      <li><a href="laboratorio_6_packetfence.html" class="no-ch">Laboratorio 6. PacketFence</a></li>
      <li><a href="prctica_4_acceso_a_la_web_a_travs_de_un_nac.html" class="no-ch">Práctica 4. Acceso a la web a través de un NAC</a></li>
   </ul>
   </li>
   <li><a href="9_gestin_de_cuentas_privilegiadas.html" class="daddy">9. Gestión de cuentas privilegiadas</a>
   <ul class="other-section">
      <li><a href="101_pam.html" class="no-ch">10.1 PAM</a></li>
      <li><a href="tarea_10_ejecutar_como.html" class="no-ch">Tarea 10. Ejecutar como</a></li>
   </ul>
   </li>
   <li><a href="10_protocolos_radius_y_tacacs_servicio_kerberos.html" class="daddy">10. Protocolos RADIUS y TACACS, servicio KERBEROS</a>
   <ul class="other-section">
      <li><a href="laboratorio_7_freeradius.html" class="daddy">Laboratorio 7. freeRadius</a>
      <ul class="other-section">
         <li><a href="1_instalacin_servidor_radius.html" class="no-ch">1. Instalación servidor Radius</a></li>
         <li><a href="2_instalacin_cliente_radius.html" class="no-ch">2. Instalación Cliente Radius</a></li>
      </ul>
      </li>
      <li><a href="laboratorio_8_radius_windows_server.html" class="no-ch">Laboratorio 8. Radius Windows Server</a></li>
   </ul>
   </li>
   <li><a href="11_ldap.html" class="daddy">11. LDAP</a>
   <ul class="other-section">
      <li><a href="111_instalacin_y_configuracin_de_ldap.html" class="no-ch">11.1 Instalación y configuración de LDAP.</a></li>
      <li><a href="112_configuracin_de_certificados_ssltsl_en_ldap.html" class="no-ch">11.2 Configuración de certificados SSL/TSL en LDAP.</a></li>
      <li><a href="113_creacin_de_cuentas_ldap.html" class="no-ch">11.3 Creación de cuentas LDAP</a></li>
      <li><a href="114_instalacin_de_sssd_en_el_cliente_ubuntu_desktop.html" class="no-ch">11.4 Instalación de SSSD en el cliente Ubuntu Desktop</a></li>
      <li><a href="proyecto_instalar_servidor_de_autenticacin_openldap_servidor_ubuntu.html" class="no-ch">Proyecto. Instalar servidor de autenticación OpenLdap Servidor Ubuntu</a></li>
   </ul>
   </li>
   <li><a href="12_referencias.html" class="no-ch">12. Referencias</a></li>
</ul>
</div>
<div id='topPagination'>
<div class="pagination noprt">
<a href="7_sistemas_de_control_de_acceso_y_autenticacin.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="72_certificados_digitales_gestin_de_una_pki.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</div>
</div>
<div id="main-wrapper">
<div id="main"><a name="main"></a>
<div id="nodeDecoration"><h1 id="nodeTitle">7.1 Creación de claves SSH</h1></div>
<div class="iDevice_wrapper FreeTextIdevice" id="id142">
<div class="iDevice emphasis0">
<div id="ta142_85" class="block iDevice_content">
<h3 style="text-align: justify;"><strong>1. Introducción</strong></h3>
<p style="text-align: justify;">El <a href="https://es.wikipedia.org/wiki/Secure_Shell" target="_blank" rel="noopener"><strong>protocolo SSH</strong></a> (Secure SHELL) proporciona un método seguro de acceder a un servidor privado mediante el uso de credenciales, usuario y contraseña.</p>
<p style="text-align: justify;">Tanto la contraseña como el usuario pueden ser robados por cualquier atacante, esto pondría en riesgo la confidencialidad de la información. Para solucionar este problema se ofrece el uso de claves SSH, que a diferencia de las contraseñas, son más complicadas o incluso casi imposibles de descifrar.</p>
<p style="text-align: justify;">Las <strong>claves SSH</strong> consisten en la creación de un par de claves vinculadas y que se crean juntas. Por cada usuario se generan dos largas cadenas de caracteres cada un correspondiente a cada clave. Una es la <strong><em>clave pública</em> </strong>y la otra es la <strong><em>clave privada</em></strong>. </p>
<ul>
<li style="text-align: justify;"><strong>Clave privada:</strong> se utiliza para firmar certificados y para asegurar y verificar conexiones. Las claves privadas van en claro, por lo que cualquier persona que tenga acceso a este fichero podrá interactuar con él. Por este motivo la clave privada debe de estar protegida y nunca ser compartida con nadie.</li>
<li style="text-align: justify;"><strong>Clave pública:</strong> se utiliza junto a una clave privada para comprobar que los datos están encriptados y verificados. Gracias a esta se puede comprobar la verificación de los datos sin necesidad de conocer la clave privada.</li>
</ul>
<p style="text-align: justify;">La <strong>clave pública</strong> de un usuario se instala en cualquier servidor y se desbloquea mediante la conexión con un cliente que hace uso de la clave privada. En el caso que las dos claves tengan exactitud, es decir, que coincidan, el sistema permite el acceso sin necesidad de tener que utilizar contraseña. Pero si queremos aumentar esta seguridad, podemos implementar una contraseña en la clave privada.</p>
<p style="text-align: justify;">Esta práctica nos enseña a evitar el ataque conocido como <a href="https://www.incibe.es/protege-tu-empresa/blog/el-ataque-del-man-middle-empresa-riesgos-y-formas-evitarlo" target="_blank" rel="noopener"><strong>Man-in-the-middle</strong></a><strong> (</strong>La técnica de hacking "Man-in-the-middle" la podemos evitar con la creación de claves en el protocolo SSH).</p>
<h3 style="text-align: justify;">2.  Creación de claves SSH</h3>
<h4>2.1 Procedimiento para la creación de sshkey</h4>
<p>Recursos necesarios:</p>
<ul>
<li>Un cliente Linux donde generar las claves.</li>
<li>Un servidor Linux con SSH sobre el que realizar la conexión con claves.</li>
</ul>
<p style="text-align: justify;">Para generar un <strong>par de claves RSA</strong> (algoritmo de cifrado) de 4096 bits (la longitud en bits) en el equipo Linux cliente, utilizamos el comando ssh-keygen. El comando es el siguiente:</p>
<pre><span style="font-size: 12pt;"><b>jc@jc-Latitude-E6430:~$</b>ssh-keygen -t rsa -b 4096</span></pre>
<p style="text-align: justify;">Las <strong>claves públicas</strong> se crean usando el mismo nombre base que la clave privada, con una extensión<strong> .pub</strong>.</p>
<p style="text-align: justify;">La ubicación de momento se deja por defecto. Si se quieren guardar las claves en otra ruta, hay que poner la opción -f y la ruta en cuestión:</p>
<pre><span style="font-size: 12pt;"><b>jc@jc-Latitude-E6430:~$</b>ssh-keygen -f ~/ruta -t rsa -b 4096</span></pre>
<p style="text-align: justify;">Al ejecutar el comando, también se solicita la opción de poner nombre a estas claves. Para este caso de ejemplo, se pone "jcrequena" y para mejorar la seguridad de estos se le introducimos una passphrase con requitiso complejos. Esta será requerida para cargar la clave privada y que se usará cuando conectes a través de SSH. Esto hace que la seguridad obviamente sea mayor, pero también dificultará la automatización.</p>
<p>Esto creará una clave privada escrita en<strong> /home/jc/jcrequena</strong> y una clave pública escrita en<strong> /home/jc/jcrequena.pub</strong>.</p>
<h4>2.2 Clave pública</h4>
<p style="text-align: justify;">Esta es la <strong>clave pública</strong> que se debe almacenar en el servidor al que se quiere acceder remotamente, más concretamente en el archivo /home/usuario/.ssh/authorized_keys.</p>
<p style="text-align: center;"><img src="jcrequena-pub.png" alt="" width="946" height="159" /></p>
<h4>2.3 Copiado de la clave</h4>
<p style="text-align: justify;">Se pueden utilizar diferentes opciones para trasladar la clave ssh al ordenador que se desee.</p>
<ol>
<li style="text-align: justify;">Introducirla manualmente en /usuario/.ssh/authorized_keys.</li>
<li style="text-align: justify;">Copiarlo vía scp al ordenador remoto.</li>
<li style="text-align: justify;">Mediante el comando ssh-copy-id: $ ssh-copy-id -i ~/jcrequena.pub orion@192.168.0.25</li>
</ol>
<div class="cuadro-importante-centro">
<p style="text-align: justify;">Nos pedirá introducir la contraseña de un usuario (no es necesario que sea administrador) del ordenador remoto para copiarla. Por lo tanto, es necesario disponer de acceso común con un usuario del servidor donde vamos a copiar la clave pública antes de hacer esto.</p>
</div>
<p style="text-align: justify;">Para este caso, se hace uso del comando<strong> ssh-copy-id</strong>.</p>
<pre><span style="font-size: 12pt;"><b>jc@jc-Latitude-E6430:~$</b>ssh-copy-id -i ~/jcrequena.pub administrador@192.168.0.25</span></pre>
<p style="text-align: center;"><img src="copy-id.png" alt="" width="937" height="259" /></p>
<h4>2.4 Acceso remoto vía ssh con el certificado</h4>
<p style="text-align: justify;">Llegados a este punto, ya podemos conectarnos por ssh mediante certificado, para ello, utilizaremos ssh -i para seleccionar el certificado que deseamos. Si no usamos -i, seleccionará el certificado por defecto.</p>
<p style="text-align: justify;">El comando es el siguiente. Cuando vayamos a acceder nos pedirá una contraseña, pero esta será la clave privada de nuestro cliente.</p>
<pre><span style="font-size: 12pt;"><b>jc@jc-Latitude-E6430:~$</b>ssh -i ~/jcrequena administrador@192.168.0.25</span></pre>
<p style="text-align: center;"><img src="ssh-i.png" alt="" width="598" height="481" /></p>
</div>
</div>
</div>
<div id="packageLicense" class="cc cc-by-nc-sa">
<p><span>Obra publicada con</span> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Licencia Creative Commons Reconocimiento No comercial Compartir igual 4.0</a></p>
</div>
</div>
</div>
<div id='bottomPagination'>
<div class="pagination noprt">
<a href="7_sistemas_de_control_de_acceso_y_autenticacin.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="72_certificados_digitales_gestin_de_una_pki.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</div>
</div>
</div>
<script type="text/javascript" src="_style_js.js"></script></body></html>