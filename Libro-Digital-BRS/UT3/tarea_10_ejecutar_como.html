<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="es" xml:lang="es" xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>Tarea 10. Ejecutar como | UT3. Sistemas de control de acceso y credenciales </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta http-equiv="content-language" content="es" />
<meta name="author" content="Juan Carlos Requena" />
<link rel="license" type="text/html" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" />
<meta name="generator" content="eXeLearning 2.7 - exelearning.net" />
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body class="exe-web-site" id="exe-node-58"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Saltar la navegación</a></p>
<div id="header"  style="background-image: url(logoJCRequena.png); background-repeat: no-repeat;"><div id="headerContent">UT3. Sistemas de control de acceso y credenciales</div></div>
<div id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">UT3. Sistemas de control de acceso y credenciales</a></li>
   <li><a href="objetivos.html" class="no-ch">Objetivos</a></li>
   <li><a href="recomendaciones_de_estudio__resumen.html" class="no-ch">Recomendaciones de estudio - Resumen</a></li>
   <li><a href="1_mecanismos_de_autenticacin_tipos_de_factores.html" class="daddy">1. Mecanismos de autenticación. Tipos de factores.</a>
   <ul class="other-section">
      <li><a href="11_mltiples_factores_de_autenticacin.html" class="no-ch">1.1 Múltiples factores de autenticación</a></li>
      <li><a href="tarea_1_autenticacin_de_doble_factor_por_ssh_con_google_authenticator.html" class="no-ch">Tarea 1. Autenticación de doble factor por SSH con Google Authenticator</a></li>
      <li><a href="laboratorio_1_autenticacin_multifactor_con_yubico.html" class="no-ch">Laboratorio 1. Autenticación multifactor con Yubico</a></li>
      <li><a href="tarea_2_ubuntu__2fa_para_login_con_yubico_security_key.html" class="no-ch">Tarea 2. Ubuntu - 2FA para login con Yubico Security Key</a></li>
   </ul>
   </li>
   <li><a href="2_tcnicas_de_autenticacin.html" class="no-ch">2. Técnicas de autenticación</a></li>
   <li><a href="3_gestin_de_credenciales.html" class="daddy">3. Gestión de credenciales</a>
   <ul class="other-section">
      <li><a href="31_lastpass.html" class="no-ch">3.1 LastPass</a></li>
      <li><a href="32_keepass.html" class="no-ch">3.2 Keepass</a></li>
      <li><a href="33_otros_gestores_de_contraseas.html" class="no-ch">3.3 Otros gestores de contraseñas</a></li>
      <li><a href="tarea_3_instalacin_configuracin_y_puesta_en_produccin_de_un_gestor_de_credenciales.html" class="no-ch">Tarea 3. Instalación, configuración y puesta en producción de un gestor de credenciales</a></li>
      <li><a href="34_brechas_de_seguridad_y_contraseas_inseguras.html" class="no-ch">3.4 Brechas de seguridad y contraseñas inseguras</a></li>
   </ul>
   </li>
   <li><a href="4_acceso_por_medio_de_firma_electrnica.html" class="daddy">4. Acceso por medio de firma electrónica</a>
   <ul class="other-section">
      <li><a href="41_lectores_de_dnie.html" class="no-ch">4.1 Lectores de DNIe</a></li>
      <li><a href="42_uso_de_nfc_con_el_dnie.html" class="no-ch">4.2 Uso de NFC con el DNIe</a></li>
   </ul>
   </li>
   <li><a href="5_sistemas_de_single_sign_on_sso.html" class="daddy">5. Sistemas de Single Sign On SSO</a>
   <ul class="other-section">
      <li><a href="tarea_4_sistemas_sso.html" class="no-ch">Tarea 4. Sistemas SSO</a></li>
   </ul>
   </li>
   <li><a href="6_criptografa.html" class="daddy">6. Criptografía</a>
   <ul class="other-section">
      <li><a href="61_aplicacin_de_la_criptografa_en_la_seguridad_de_la_informacin.html" class="daddy">6.1 Aplicación de la Criptografía en la seguridad de la información</a>
      <ul class="other-section">
         <li><a href="611_principios_bsicos_de_la_criptografa.html" class="no-ch">6.1.1 Principios básicos de la criptografía</a></li>
         <li><a href="612_criptografa_clsica.html" class="no-ch">6.1.2 Criptografía clásica</a></li>
         <li><a href="613_servicios_de_seguridad_de_criptografa.html" class="no-ch">6.1.3 Servicios de seguridad de criptografía</a></li>
         <li><a href="614_criptografa_moderna.html" class="daddy">6.1.4 Criptografía Moderna</a>
         <ul class="other-section">
            <li><a href="6141_criptografa_de_clave_privada.html" class="daddy">6.1.4.1 Criptografía de clave privada</a>
            <ul class="other-section">
               <li><a href="laboratorio_1_cifrado_simtrico_de_archivos.html" class="no-ch">Laboratorio 1. Cifrado simétrico de archivos</a></li>
               <li><a href="prctica_1_cifrado_simtrico.html" class="no-ch">Práctica 1. Cifrado simétrico</a></li>
            </ul>
            </li>
            <li><a href="6142_criptografa_de_clave_pblica.html" class="daddy">6.1.4.2 Criptografía de clave pública</a>
            <ul class="other-section">
               <li><a href="laboratorio_2_cifrado_asimtrico_de_ficheros.html" class="no-ch">Laboratorio 2. Cifrado asimétrico de ficheros</a></li>
               <li><a href="prctica_2cifrado_asimtrico.html" class="no-ch">Práctica 2.Cifrado Asimétrico</a></li>
            </ul>
            </li>
            <li><a href="6143_ventas_y_desventajas_cifrado_simtrico_y_asimetrico.html" class="no-ch">6.1.4.3 Ventas y desventajas cifrado simétrico y asimetrico</a></li>
            <li><a href="6144_criptografa_hbirida.html" class="no-ch">6.1.4.4 Criptografía híbirida</a></li>
         </ul>
         </li>
         <li><a href="615_esteganografa.html" class="daddy">6.1.5 Esteganografía</a>
         <ul class="other-section">
            <li><a href="tarea_5_openstego.html" class="no-ch">Tarea 5. OpenStego</a></li>
         </ul>
         </li>
         <li><a href="616_funciones_hash.html" class="daddy">6.1.6 Funciones hash</a>
         <ul class="other-section">
            <li><a href="tarea_6_funciones_hash.html" class="no-ch">Tarea 6. Funciones hash</a></li>
            <li><a href="tarea_7_quickhash.html" class="no-ch">Tarea 7. QuickHash</a></li>
            <li><a href="tarea_8_funciones_avanzadas_hash_de_powershell.html" class="no-ch">Tarea 8. Funciones avanzadas hash de powershell</a></li>
            <li><a href="laboratorio_3_funciones_hash_con_kleopatra.html" class="no-ch">Laboratorio 3. Funciones hash con Kleopatra</a></li>
         </ul>
         </li>
         <li><a href="617_uso_de_tcnicas_criptogrficas_en_las_pyme.html" class="no-ch">6.1.7 Uso de técnicas criptográficas en las PYME</a></li>
         <li><a href="618_sistemas_encriptacin_hardware_tpmhsm.html" class="no-ch">6.1.8 Sistemas encriptación hardware (TPM/HSM)</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="7_sistemas_de_control_de_acceso_y_autenticacin.html" class="daddy">7. Sistemas de control de acceso y autenticación</a>
   <ul class="other-section">
      <li><a href="71_creacin_de_claves_ssh.html" class="no-ch">7.1 Creación de claves SSH</a></li>
      <li><a href="72_certificados_digitales_gestin_de_una_pki.html" class="daddy">7.2. Certificados digitales, gestión de una PKI</a>
      <ul class="other-section">
         <li><a href="721_certificados_digitales.html" class="daddy">7.2.1 Certificados digitales</a>
         <ul class="other-section">
            <li><a href="laboratorio_4_certificado_personal.html" class="no-ch">Laboratorio 4. Certificado personal</a></li>
            <li><a href="tarea_9_verificacin_de_certificados_digitales.html" class="no-ch">Tarea 9. Verificación de certificados digitales</a></li>
         </ul>
         </li>
         <li><a href="722_firma_digital.html" class="daddy">7.2.2 Firma digital</a>
         <ul class="other-section">
            <li><a href="prctica_3_verificacin_de_la_autenticidad_e_integridad_de_un_mensaje.html" class="no-ch">Práctica 3: Verificación de la autenticidad e integridad de un mensaje</a></li>
         </ul>
         </li>
         <li><a href="723_infraestructuras_de_clave_pblica_pki.html" class="no-ch">7.2.3 Infraestructuras de clave pública (PKI)</a></li>
         <li><a href="laboratorio_5_infraestructura_de_clave_pblica_propia_con_openssl.html" class="no-ch">Laboratorio 5. Infraestructura de clave pública propia con OpenSSL</a></li>
         <li><a href="caso_prctico_uso_de_certificados_en_servicios_web.html" class="no-ch">Caso Práctico. Uso de certificados en Servicios WEB</a></li>
         <li><a href="reto_implementacin_de_una_sistema_de_certificados_pki_en_la_organizacin_con_easyrsa.html" class="no-ch">Reto. Implementación de una sistema de certificados (PKI) en la organización con Easy-RSA</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="8_gestin_de_accesos_sistemas_nac.html" class="daddy">8. Gestión de accesos. Sistemas NAC</a>
   <ul class="other-section">
      <li><a href="laboratorio_6_packetfence.html" class="no-ch">Laboratorio 6. PacketFence</a></li>
      <li><a href="prctica_4_acceso_a_la_web_a_travs_de_un_nac.html" class="no-ch">Práctica 4. Acceso a la web a través de un NAC</a></li>
   </ul>
   </li>
   <li class="current-page-parent"><a href="9_gestin_de_cuentas_privilegiadas.html" class="current-page-parent daddy">9. Gestión de cuentas privilegiadas</a>
   <ul>
      <li><a href="101_pam.html" class="no-ch">10.1 PAM</a></li>
      <li id="active"><a href="tarea_10_ejecutar_como.html" class="active no-ch">Tarea 10. Ejecutar como</a></li>
   </ul>
   </li>
   <li><a href="10_protocolos_radius_y_tacacs_servicio_kerberos.html" class="daddy">10. Protocolos RADIUS y TACACS, servicio KERBEROS</a>
   <ul class="other-section">
      <li><a href="laboratorio_7_freeradius.html" class="daddy">Laboratorio 7. freeRadius</a>
      <ul class="other-section">
         <li><a href="1_instalacin_servidor_radius.html" class="no-ch">1. Instalación servidor Radius</a></li>
         <li><a href="2_instalacin_cliente_radius.html" class="no-ch">2. Instalación Cliente Radius</a></li>
      </ul>
      </li>
      <li><a href="laboratorio_8_radius_windows_server.html" class="no-ch">Laboratorio 8. Radius Windows Server</a></li>
   </ul>
   </li>
   <li><a href="11_ldap.html" class="daddy">11. LDAP</a>
   <ul class="other-section">
      <li><a href="111_instalacin_y_configuracin_de_ldap.html" class="no-ch">11.1 Instalación y configuración de LDAP.</a></li>
      <li><a href="112_configuracin_de_certificados_ssltsl_en_ldap.html" class="no-ch">11.2 Configuración de certificados SSL/TSL en LDAP.</a></li>
      <li><a href="113_creacin_de_cuentas_ldap.html" class="no-ch">11.3 Creación de cuentas LDAP</a></li>
      <li><a href="114_instalacin_de_sssd_en_el_cliente_ubuntu_desktop.html" class="no-ch">11.4 Instalación de SSSD en el cliente Ubuntu Desktop</a></li>
      <li><a href="proyecto_instalar_servidor_de_autenticacin_openldap_servidor_ubuntu.html" class="no-ch">Proyecto. Instalar servidor de autenticación OpenLdap Servidor Ubuntu</a></li>
   </ul>
   </li>
   <li><a href="12_referencias.html" class="no-ch">12. Referencias</a></li>
</ul>
</div>
<div id='topPagination'>
<div class="pagination noprt">
<a href="101_pam.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="10_protocolos_radius_y_tacacs_servicio_kerberos.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</div>
</div>
<div id="main-wrapper">
<div id="main"><a name="main"></a>
<div id="nodeDecoration"><h1 id="nodeTitle">Tarea 10. Ejecutar como</h1></div>
<div class="iDevice_wrapper pblIdevice em_iDevice em_iDevice_activity" id="id87">
<div class="iDevice emphasis1" >
<div class="iDevice_header" style="background-image:url(icon_activity.png)"><span class="iDeviceTitle">&nbsp;</span></div>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta87_110_2" class="block iDevice_content">
<div class="pbl-task-description"><h3>1. Introducción</h3>
<p style="text-align: justify;">Iniciar sesión con<strong><em> credenciales de administrador</em></strong> puede suponer un riesgo para la seguridad del sistema operativo y de la red (en el caso de que el ordenador forme parte). El riesgo se debe a que los usuarios administradores pueden realizar cualquier tipo de cambio en el sistema y puede darse el caso de que el administrador ejecute un programa dañino para el sistema como, por ejemplo, un virus, por este motivo, es recomendable iniciar sesión con usuarios no administradores.</p>
<p style="text-align: justify;">En <strong>PowerShell</strong> se pueden ejecutar <strong>cmdlets</strong> como administrador mediante el parámetro <strong>-Verb</strong> y el valor <strong>runAs.</strong></p>
<h3 style="text-align: justify;"><strong>2. Ejemplos de ejecución de comandos con crdenciales bajo demanda</strong></h3>
<p><strong>Realizar los siguientes puntos en el servidor de vuestro proyecto.</strong></p>
<p style="text-align: justify;"><strong>1. <span>Iniciar Powershell como Administrador</span></strong></p>
<pre><span style="font-size: 12pt;"><strong>PS C:\&gt; </strong><span class="crayon-r ">Start-Process </span><span class="crayon-cn">-FilePath </span><span class="crayon-s">"powershell" </span><span class="crayon-cn">-Verb </span><span class="crayon-i">runAs</span></span></pre>
<p style="text-align: center;"><strong><span><img src="runa-as-01.png" alt="" width="857" height="329" /></span></strong></p>
<p style="text-align: center;"><em><strong>Figura 1.</strong> Terminal powershell con credenciales de administrador.</em></p>
<p style="text-align: justify;"><span>También se pueden ejecutar los cmdlet con los credenciales de otros usuarios con el cmdlet:</span><strong><span></span></strong></p>
<pre><span style="font-size: 12pt;"><strong>PS C:\&gt; </strong>Get-Credential</span></pre>
<p style="text-align: center;"><img src="get-credential.png" alt="" width="876" height="415" /></p>
<p style="text-align: center;"><em><strong>Figura 2.</strong> Acceder con las credenciales de un usuario.</em></p>
<p style="text-align: justify;">Las credenciales de un usuario se pueden almacenar en una variable para poder utilizarlas dentro de un script.</p>
<pre><span style="font-size: 12pt;"><strong>PS C:\&gt; </strong><span class="crayon-v">$credencial</span><span class="crayon-o">= </span><span class="crayon-r ">Get-Credential </span><span class="crayon-cn">-Message </span><span class="crayon-i">Credenciales</span></span></pre>
<p style="text-align: center;"><img src="get-credentials-Var.png" alt="" width="877" height="413" /></p>
<p style="text-align: center;"><em><strong>Figura 3.</strong> Obtener las credenciales de un usuario en una variable.</em></p>
<p style="text-align: center;"><img src="get-crdential-Var-2.png" alt="" width="621" height="185" /></p>
<p style="text-align: center;"><em><strong>Figura 4.</strong> Imprimir por pantalla la variable.</em></p>
<p style="text-align: justify;">También se puede almacenar la credencial en un fichero xml, para ello, hay que utilizar el cmdlet siguiente:</p>
<pre><span style="font-size: 12pt;"><strong>PS C:\&gt; </strong>Get-Credential | Export-Clixml -Path credenciales.xml</span></pre>
<p style="text-align: center;"><img src="get-crdential-xml.png" alt="" width="899" height="367" /></p>
<p style="text-align: center;"><em><strong>Figura 5.</strong> Guardar las credenciales en un fichero xml.</em></p>
<p style="text-align: justify;">Una vez se tienen las credenciales guardadas en el fichero, se pueden utilizar para ejecutar comandos:</p>
<pre><span style="font-size: 12pt;"><strong>PS C:\&gt; </strong>$credenciales=Import-Clixml -Path credenciales.xml<br /></span></pre>
<p style="text-align: justify;"><span>#Utilizamos las credenciales en otro equipo remoto</span></p>
<pre><span style="font-size: 12pt;"><strong>PS C:\&gt; </strong>Get-WmiObject -Class Win32_BIOS -ComputerName 192.168.1.2 -Credential $credenciales<br /></span></pre>
<p style="text-align: center;"><img src="credenciales-remoto.png" alt="" width="640" height="210" /></p>
<p style="text-align: center;"><em><strong>Figura 6.</strong> Imprimir datos de la BIOS con las credenciales de un equipo remoto.</em></p>
<p style="text-align: justify;"></p>
<p style="text-align: justify;">A continuación, se va a obtener la información de la BIOS mediante las credenciales de Administrador.</p>
<pre><span style="font-size: 12pt;"><strong>PS C:\&gt; </strong>$<span class="crayon-v">credencial</span><span class="crayon-o">=</span><span class="crayon-r ">Get-Credential <br /><span class="crayon-sy"><strong>PS C:\&gt;</strong> (</span>Get-WmiObject <span class="crayon-i">Win32_BIOS </span><span class="crayon-cn">-ComputerName</span><span class="crayon-sy">(</span><span class="crayon-s">'localhost'</span><span class="crayon-sy">) </span><span class="crayon-cn">-Credential </span><span class="crayon-v">$credenciales</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-i">Version</span></span></span></pre>
<div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-614c9fa773834699513053-2"></div>
<div class="crayon-line crayon-striped-line" style="text-align: center;"><img src="get-crdential-3.png" alt="" width="843" height="283" /></div>
<div class="crayon-line crayon-striped-line" style="text-align: center;"><em><strong>Figura 6.</strong> Imprimir datos de la BIOS con las credenciales del administrador.</em></div>
<div class="crayon-line crayon-striped-line">
<h3 style="text-align: justify;"><strong>3. Trabajo a realizar</strong></h3>
<ol>
<li style="text-align: justify;">Ejecuta una serie de comandos a partir de las credenciales del administrador que estén referidos a funcionalidades críticas del mismo, ejemplo: lista de procesos, etc.</li>
<li style="text-align: justify;">Almacena varias credenciales en un fichero xml y utiliza las mismas para arrancar un proceso (powershell), ejemplo: Notepad, Calc, etc. Ayuda. Cmd-lets a utilizar:
<ul>
<li style="text-align: justify;">Export-Clixml.</li>
<li style="text-align: justify;">Start-Process.</li>
</ul>
</li>
</ol>
</div></div><div class="iDevice_buttons feedback-button js-required"><input type="button" class="feedbackbutton" value="Mostrar retroalimentación" /></div><div class="feedback js-feedback js-hidden"><p>Guardamos 2 credenciales y ejecutamos el notepad con las credenciales del usuario 2.</p>
<pre><span style="font-size: 12pt;">[PSCustomObject]@{</span><br /><span style="font-size: 12pt;">    user1 = Get-Credential -Message Usuario 1</span><br /><span style="font-size: 12pt;">    user2 = Get-Credential -Message Usuario 2</span><br /><span style="font-size: 12pt;">} | Export-Clixml -Path almacen.xml</span><br /> <br /><span style="font-size: 12pt;">Start-Process notepad -Credential (Import-Clixml .\almacen.xml).user2</span></pre></div>
</div>
</div>
</div>
</div>
</div>
<div id="packageLicense" class="cc cc-by-nc-sa">
<p><span>Obra publicada con</span> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Licencia Creative Commons Reconocimiento No comercial Compartir igual 4.0</a></p>
</div>
</div>
</div>
<div id='bottomPagination'>
<div class="pagination noprt">
<a href="101_pam.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="10_protocolos_radius_y_tacacs_servicio_kerberos.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</div>
</div>
</div>
<script type="text/javascript" src="_style_js.js"></script></body></html>