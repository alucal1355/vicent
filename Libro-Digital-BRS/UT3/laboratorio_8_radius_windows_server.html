<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="es" xml:lang="es" xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>Laboratorio 8. Radius Windows Server | UT3. Sistemas de control de acceso y credenciales </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta http-equiv="content-language" content="es" />
<meta name="author" content="Juan Carlos Requena" />
<link rel="license" type="text/html" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" />
<meta name="generator" content="eXeLearning 2.7 - exelearning.net" />
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body class="exe-web-site" id="exe-node-61"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Saltar la navegación</a></p>
<div id="header"  style="background-image: url(logoJCRequena.png); background-repeat: no-repeat;"><div id="headerContent">UT3. Sistemas de control de acceso y credenciales</div></div>
<div id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">UT3. Sistemas de control de acceso y credenciales</a></li>
   <li><a href="objetivos.html" class="no-ch">Objetivos</a></li>
   <li><a href="recomendaciones_de_estudio__resumen.html" class="no-ch">Recomendaciones de estudio - Resumen</a></li>
   <li><a href="1_mecanismos_de_autenticacin_tipos_de_factores.html" class="daddy">1. Mecanismos de autenticación. Tipos de factores.</a>
   <ul class="other-section">
      <li><a href="11_mltiples_factores_de_autenticacin.html" class="no-ch">1.1 Múltiples factores de autenticación</a></li>
      <li><a href="tarea_1_autenticacin_de_doble_factor_por_ssh_con_google_authenticator.html" class="no-ch">Tarea 1. Autenticación de doble factor por SSH con Google Authenticator</a></li>
      <li><a href="laboratorio_1_autenticacin_multifactor_con_yubico.html" class="no-ch">Laboratorio 1. Autenticación multifactor con Yubico</a></li>
      <li><a href="tarea_2_ubuntu__2fa_para_login_con_yubico_security_key.html" class="no-ch">Tarea 2. Ubuntu - 2FA para login con Yubico Security Key</a></li>
   </ul>
   </li>
   <li><a href="2_tcnicas_de_autenticacin.html" class="no-ch">2. Técnicas de autenticación</a></li>
   <li><a href="3_gestin_de_credenciales.html" class="daddy">3. Gestión de credenciales</a>
   <ul class="other-section">
      <li><a href="31_lastpass.html" class="no-ch">3.1 LastPass</a></li>
      <li><a href="32_keepass.html" class="no-ch">3.2 Keepass</a></li>
      <li><a href="33_otros_gestores_de_contraseas.html" class="no-ch">3.3 Otros gestores de contraseñas</a></li>
      <li><a href="tarea_3_instalacin_configuracin_y_puesta_en_produccin_de_un_gestor_de_credenciales.html" class="no-ch">Tarea 3. Instalación, configuración y puesta en producción de un gestor de credenciales</a></li>
      <li><a href="34_brechas_de_seguridad_y_contraseas_inseguras.html" class="no-ch">3.4 Brechas de seguridad y contraseñas inseguras</a></li>
   </ul>
   </li>
   <li><a href="4_acceso_por_medio_de_firma_electrnica.html" class="daddy">4. Acceso por medio de firma electrónica</a>
   <ul class="other-section">
      <li><a href="41_lectores_de_dnie.html" class="no-ch">4.1 Lectores de DNIe</a></li>
      <li><a href="42_uso_de_nfc_con_el_dnie.html" class="no-ch">4.2 Uso de NFC con el DNIe</a></li>
   </ul>
   </li>
   <li><a href="5_sistemas_de_single_sign_on_sso.html" class="daddy">5. Sistemas de Single Sign On SSO</a>
   <ul class="other-section">
      <li><a href="tarea_4_sistemas_sso.html" class="no-ch">Tarea 4. Sistemas SSO</a></li>
   </ul>
   </li>
   <li><a href="6_criptografa.html" class="daddy">6. Criptografía</a>
   <ul class="other-section">
      <li><a href="61_aplicacin_de_la_criptografa_en_la_seguridad_de_la_informacin.html" class="daddy">6.1 Aplicación de la Criptografía en la seguridad de la información</a>
      <ul class="other-section">
         <li><a href="611_principios_bsicos_de_la_criptografa.html" class="no-ch">6.1.1 Principios básicos de la criptografía</a></li>
         <li><a href="612_criptografa_clsica.html" class="no-ch">6.1.2 Criptografía clásica</a></li>
         <li><a href="613_servicios_de_seguridad_de_criptografa.html" class="no-ch">6.1.3 Servicios de seguridad de criptografía</a></li>
         <li><a href="614_criptografa_moderna.html" class="daddy">6.1.4 Criptografía Moderna</a>
         <ul class="other-section">
            <li><a href="6141_criptografa_de_clave_privada.html" class="daddy">6.1.4.1 Criptografía de clave privada</a>
            <ul class="other-section">
               <li><a href="laboratorio_1_cifrado_simtrico_de_archivos.html" class="no-ch">Laboratorio 1. Cifrado simétrico de archivos</a></li>
               <li><a href="prctica_1_cifrado_simtrico.html" class="no-ch">Práctica 1. Cifrado simétrico</a></li>
            </ul>
            </li>
            <li><a href="6142_criptografa_de_clave_pblica.html" class="daddy">6.1.4.2 Criptografía de clave pública</a>
            <ul class="other-section">
               <li><a href="laboratorio_2_cifrado_asimtrico_de_ficheros.html" class="no-ch">Laboratorio 2. Cifrado asimétrico de ficheros</a></li>
               <li><a href="prctica_2cifrado_asimtrico.html" class="no-ch">Práctica 2.Cifrado Asimétrico</a></li>
            </ul>
            </li>
            <li><a href="6143_ventas_y_desventajas_cifrado_simtrico_y_asimetrico.html" class="no-ch">6.1.4.3 Ventas y desventajas cifrado simétrico y asimetrico</a></li>
            <li><a href="6144_criptografa_hbirida.html" class="no-ch">6.1.4.4 Criptografía híbirida</a></li>
         </ul>
         </li>
         <li><a href="615_esteganografa.html" class="daddy">6.1.5 Esteganografía</a>
         <ul class="other-section">
            <li><a href="tarea_5_openstego.html" class="no-ch">Tarea 5. OpenStego</a></li>
         </ul>
         </li>
         <li><a href="616_funciones_hash.html" class="daddy">6.1.6 Funciones hash</a>
         <ul class="other-section">
            <li><a href="tarea_6_funciones_hash.html" class="no-ch">Tarea 6. Funciones hash</a></li>
            <li><a href="tarea_7_quickhash.html" class="no-ch">Tarea 7. QuickHash</a></li>
            <li><a href="tarea_8_funciones_avanzadas_hash_de_powershell.html" class="no-ch">Tarea 8. Funciones avanzadas hash de powershell</a></li>
            <li><a href="laboratorio_3_funciones_hash_con_kleopatra.html" class="no-ch">Laboratorio 3. Funciones hash con Kleopatra</a></li>
         </ul>
         </li>
         <li><a href="617_uso_de_tcnicas_criptogrficas_en_las_pyme.html" class="no-ch">6.1.7 Uso de técnicas criptográficas en las PYME</a></li>
         <li><a href="618_sistemas_encriptacin_hardware_tpmhsm.html" class="no-ch">6.1.8 Sistemas encriptación hardware (TPM/HSM)</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="7_sistemas_de_control_de_acceso_y_autenticacin.html" class="daddy">7. Sistemas de control de acceso y autenticación</a>
   <ul class="other-section">
      <li><a href="71_creacin_de_claves_ssh.html" class="no-ch">7.1 Creación de claves SSH</a></li>
      <li><a href="72_certificados_digitales_gestin_de_una_pki.html" class="daddy">7.2. Certificados digitales, gestión de una PKI</a>
      <ul class="other-section">
         <li><a href="721_certificados_digitales.html" class="daddy">7.2.1 Certificados digitales</a>
         <ul class="other-section">
            <li><a href="laboratorio_4_certificado_personal.html" class="no-ch">Laboratorio 4. Certificado personal</a></li>
            <li><a href="tarea_9_verificacin_de_certificados_digitales.html" class="no-ch">Tarea 9. Verificación de certificados digitales</a></li>
         </ul>
         </li>
         <li><a href="722_firma_digital.html" class="daddy">7.2.2 Firma digital</a>
         <ul class="other-section">
            <li><a href="prctica_3_verificacin_de_la_autenticidad_e_integridad_de_un_mensaje.html" class="no-ch">Práctica 3: Verificación de la autenticidad e integridad de un mensaje</a></li>
         </ul>
         </li>
         <li><a href="723_infraestructuras_de_clave_pblica_pki.html" class="no-ch">7.2.3 Infraestructuras de clave pública (PKI)</a></li>
         <li><a href="laboratorio_5_infraestructura_de_clave_pblica_propia_con_openssl.html" class="no-ch">Laboratorio 5. Infraestructura de clave pública propia con OpenSSL</a></li>
         <li><a href="caso_prctico_uso_de_certificados_en_servicios_web.html" class="no-ch">Caso Práctico. Uso de certificados en Servicios WEB</a></li>
         <li><a href="reto_implementacin_de_una_sistema_de_certificados_pki_en_la_organizacin_con_easyrsa.html" class="no-ch">Reto. Implementación de una sistema de certificados (PKI) en la organización con Easy-RSA</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="8_gestin_de_accesos_sistemas_nac.html" class="daddy">8. Gestión de accesos. Sistemas NAC</a>
   <ul class="other-section">
      <li><a href="laboratorio_6_packetfence.html" class="no-ch">Laboratorio 6. PacketFence</a></li>
      <li><a href="prctica_4_acceso_a_la_web_a_travs_de_un_nac.html" class="no-ch">Práctica 4. Acceso a la web a través de un NAC</a></li>
   </ul>
   </li>
   <li><a href="9_gestin_de_cuentas_privilegiadas.html" class="daddy">9. Gestión de cuentas privilegiadas</a>
   <ul class="other-section">
      <li><a href="101_pam.html" class="no-ch">10.1 PAM</a></li>
      <li><a href="tarea_10_ejecutar_como.html" class="no-ch">Tarea 10. Ejecutar como</a></li>
   </ul>
   </li>
   <li class="current-page-parent"><a href="10_protocolos_radius_y_tacacs_servicio_kerberos.html" class="current-page-parent daddy">10. Protocolos RADIUS y TACACS, servicio KERBEROS</a>
   <ul>
      <li><a href="laboratorio_7_freeradius.html" class="daddy">Laboratorio 7. freeRadius</a>
      <ul class="other-section">
         <li><a href="1_instalacin_servidor_radius.html" class="no-ch">1. Instalación servidor Radius</a></li>
         <li><a href="2_instalacin_cliente_radius.html" class="no-ch">2. Instalación Cliente Radius</a></li>
      </ul>
      </li>
      <li id="active"><a href="laboratorio_8_radius_windows_server.html" class="active no-ch">Laboratorio 8. Radius Windows Server</a></li>
   </ul>
   </li>
   <li><a href="11_ldap.html" class="daddy">11. LDAP</a>
   <ul class="other-section">
      <li><a href="111_instalacin_y_configuracin_de_ldap.html" class="no-ch">11.1 Instalación y configuración de LDAP.</a></li>
      <li><a href="112_configuracin_de_certificados_ssltsl_en_ldap.html" class="no-ch">11.2 Configuración de certificados SSL/TSL en LDAP.</a></li>
      <li><a href="113_creacin_de_cuentas_ldap.html" class="no-ch">11.3 Creación de cuentas LDAP</a></li>
      <li><a href="114_instalacin_de_sssd_en_el_cliente_ubuntu_desktop.html" class="no-ch">11.4 Instalación de SSSD en el cliente Ubuntu Desktop</a></li>
      <li><a href="proyecto_instalar_servidor_de_autenticacin_openldap_servidor_ubuntu.html" class="no-ch">Proyecto. Instalar servidor de autenticación OpenLdap Servidor Ubuntu</a></li>
   </ul>
   </li>
   <li><a href="12_referencias.html" class="no-ch">12. Referencias</a></li>
</ul>
</div>
<div id='topPagination'>
<div class="pagination noprt">
<a href="2_instalacin_cliente_radius.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="11_ldap.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</div>
</div>
<div id="main-wrapper">
<div id="main"><a name="main"></a>
<div id="nodeDecoration"><h1 id="nodeTitle">Laboratorio 8. Radius Windows Server</h1></div>
<div class="iDevice_wrapper pblIdevice em_iDevice em_iDevice_activity" id="id91">
<div class="iDevice emphasis1" >
<div class="iDevice_header" style="background-image:url(icon_activity.png)"><h2 class="iDeviceTitle">Laboratorio. Implantación de RADIUS</h2></div>
<div class="iDevice_inner">
<div class="iDevice_content_wrapper">
<div id="ta91_109_2" class="block iDevice_content">
<div class="pbl-task-description"><h3>1. Recursos y escenario previo</h3>
<ul>
<li align="justify">Windows Server 2019.</li>
</ul>
<p align="justify"><strong>Requisitos previos necesarios (Escenario):</strong></p>
<ul>
<li align="justify">Antes de realizar una instalación de RADIUS en Windows, necesitamos que en la red exista un Controlador de Dominio.</li>
<li align="justify">Todo lo realizaremos sobre el mismo servidor, es decir, el servidor será Controlador del Dominio y servidor RADIUS.</li>
<li align="justify">Poner un nombre al servidor descriptivo, ejemplo, AD-001.</li>
</ul>
<h3>2. Procedimiento</h3>
<h4>2.1. Instalar el Rol de Servicio de Active Directory.</h4>
<p style="text-align: center;"><img src="labRadius-001.png" alt="" width="387" height="171" /></p>
<p style="text-align: justify;" align="justify"><b>Seleccionar Agregar roles y características. </b>Seguir el asistente para promocionar el servidor como Controlador del Dominio. Instalamos los servicios de dominio de <strong>AD y DNS</strong>.</p>
<p style="text-align: center;"><iframe width="560" height="314" src="https://www.youtube.com/embed/8T9Q-HtJBXI" allowfullscreen="allowfullscreen"></iframe></p>
<p style="text-align: center;"><em><strong>Vídeo 1.</strong> Promocionar servidor a Controlador del Domino.</em></p>
<div class="cuadro-nota-centro-new">
<p align="justify">La ip del servidor ha de ser fija. En caso contrario, en la promoción a CD nos dará un warning. </p>
</div>
<h4>2.2. Instalar Radius</h4>
<p align="justify">Una vez se tiene el entorno listo, procedemos a instalar RADIUS, para ello, hay que seleccionar Agregar roles y características de la opción '<strong>Administrar</strong>' del Panel principal.</p>
<p style="text-align: center;" align="justify"><img src="labRadius-001.png" alt="" width="387" height="171" /></p>
<p align="justify"><span>A continuación, hay que seleccionar </span><b>‘Servicios de acceso y directivas de redes’. </b>Una vez se finaliza la instalación del Rol, se crea en el panel un nuevo rol llamado <b>NPAS</b>.</p>
<p align="justify">Una vez instalado el servicio, hay que crear un nuevo grupo en AD al que llamaremos Radius, para ello, vamos a ‘<strong><em>Usuarios y equipos de Active Directory</em></strong>’ y creamos el grupo Global y de seguridad ‘radius’. Este grupo es el que se utilizará para integrar en el mismo aquellos usuarios del dominio que se autenticarán con Radius.</p>
<p style="text-align: center;" align="justify"><img src="labRadius-003.png" alt="" width="436" height="376" /></p>
<p align="justify"><span>A continuación, creamos un usuario </span><span>que incluiremos en el grupo para permitirle conectar al servidor radius. Las credenciales del usuario serán las siguientes:</span></p>
<ul>
<li align="justify">cuenta: <span>radiustest</span></li>
<li align="justify">password: <span>Camina-100</span></li>
<li align="justify"><span>La contraseña nunca caduca.</span></li>
</ul>
<p align="justify"><span><a href="https://docs.microsoft.com/es-es/windows/security/threat-protection/security-policy-settings/password-must-meet-complexity-requirements"><strong>NOTA:</strong> La contraseña debe cumplir los requisitos de complejidad.</a></span></p>
<p align="justify">Con el comando net accounts, podemos comprobar los requisitos de contraseña configurados.</p>
<pre><span style="font-size: 12pt;"><b>C:\&gt; </b>net accounts</span></pre>
<p style="text-align: center;"><img src="labRadius-004.png" alt="" width="590" height="193" /></p>
<p align="justify"><strong>Referencia:</strong></p>
<ul>
<li align="justify"><a href="http://somebooks.es/crear-una-cuenta-de-usuario-del-dominio-en-la-interfaz-grafica-de-windows-server-2019/">http://somebooks.es/crear-una-cuenta-de-usuario-del-dominio-en-la-interfaz-grafica-de-windows-server-2019/</a></li>
</ul>
<p>A continuación, se muestra la pantalla de creación del nuevo usuario.</p>
<p style="text-align: center;"><img src="labRadius-005.png" alt="" width="434" height="376" /></p>
<p style="text-align: justify;">El siguiente paso es incluir el usuario en el grupo <strong>radius</strong>, para ello, abrimos una consola en Powershell y ejecutamos el siguiente cmd let:</p>
<pre><span style="font-size: 12pt;"><b>PS C:\&gt;</b><span style="color: #222222;"><span style="font-family: Carme, Verdana, Arial, Tahoma;">Add-ADGroupMember </span></span><span style="color: #222222;"><span style="font-family: Carme, Verdana, Arial, Tahoma;">-Identity radius -Members radiustest</span></span></span></pre>
<p style="text-align: center;" align="justify"><img src="labRadius-006.png" alt="" width="586" height="58" /></p>
<h4 align="justify">Activar el marcado en el usuario</h4>
<p align="justify">A continuación, hay que acceder a las propiedades del usuarios creado y activamos en la pestaña de marcado del usuario ‘<strong>Permiso de acceso a redes</strong>’ → Permitir acceso.</p>
<p style="text-align: center;" align="justify"><img src="labRadius-007.png" alt="" width="449" height="536" /></p>
<p style="text-align: justify;" align="justify">Con esto, tenemos el usuario configurado y listo.</p>
<h4 style="text-align: justify;" align="justify">Configurar el ‘Servidor de directivas de redes’</h4>
<p>Hay que acceder a la herramienta ‘<strong>Servidor de directivas de redes</strong>’, para crear un nuevo <strong><em>cliente RADIUS</em></strong>.</p>
<p style="text-align: center;"><img src="labRadius-008.png" alt="" width="779" height="558" /></p>
<p style="text-align: justify;">Estando en el nodo '<em><strong>Clientes RADIUS</strong></em>' del árbol de la izquierda (ver imagen inferior), pulsamos el botón derecho del ratón y seleccionamos '<strong>Nuevo</strong>'. </p>
<p style="text-align: center;"><img src="labRadius-009.png" alt="" width="958" height="585" /></p>
<p style="text-align: justify;">En la pantalla de la imagen inferior, introducimos los siguientes datos:</p>
<ul>
<li style="text-align: justify;">'Cliente-Radius' es el <strong>nombre</strong> que le ponemos al equipo NAS (cliente radius)</li>
<li style="text-align: justify;">La<strong> dirección ip</strong> del equipo NAS,</li>
<li style="text-align: justify;">El <strong>secreto compartido</strong>, ponemos una contraseña, para este caso de ejemplo: <strong>CcliRadius</strong>.</li>
</ul>
<p style="text-align: center;"><img src="labRadius-010.png" alt="" width="454" height="585" /></p>
<p style="text-align: justify;">Pulsamos Aceptar, y ya tendremos configurado el cliente Radius.</p>
<p style="text-align: center;"><img src="labRadius-011.png" alt="" width="784" height="382" /></p>
<p style="text-align: justify;">El siguiente paso es <strong><em>configurar las Directivas</em></strong>, para ello, en el nodo '<strong>Directivas de red</strong>' (está dentro del nodo directivas) del árbol izquierdo (ver imagen superior) → pulsamos el botón derecho del ratón y seleccionamos '<strong>Nuevo</strong>'.</p>
<p style="text-align: justify;">En la Pantalla de  '<strong>Nueva directiva de red</strong>' hay que introducir un nombre, para este caso de ejemplo, le ponemos '<strong>VPN Administracion</strong>', ya que los usuarios del departamento de Administración se autenticarán en el servidor Radius por medio de una VPN. En el '<strong>Tipo de servidor de acceso a la red</strong>', seleccionamos Servidor de acceso remoto (VPN).</p>
<p style="text-align: center;"><img src="labRadius-012.png" alt="" width="744" height="601" /></p>
<p style="text-align: justify;">Pulsamos '<strong>Siguiente</strong>' para avanzar. </p>
<p style="text-align: justify;">En la Pantalla de ‘<strong>Especificar Condiciones</strong>’ → Pulsamos ‘<strong>Agregar</strong>’ y vamos a seleccionar ‘<strong>Grupos de Windows</strong>’.</p>
<p><img src="labRadius-013.png" alt="" style="display: block; margin-left: auto; margin-right: auto;" width="741" height="601" /></p>
<p style="text-align: justify;">Después en ‘<strong>Grupos</strong>’ → Seleccionamos el grupo <strong>radius</strong> (el que creamos). Es decir, daremos acceso los usuarios que pertenezcan al grupo radius.</p>
<p style="text-align: center;"><img src="labRadius-014.png" alt="" width="404" height="309" /></p>
<p style="text-align: justify;">Una vez agregado el grupo, pulsamos ‘<strong>Siguiente</strong>’ par continuar.</p>
<p style="text-align: justify;">En la pantalla de ‘<strong>Especificar permiso de acceso</strong>’, seleccionamos '<strong>Acceso concedido</strong>' y  pulsamos ‘<strong>Siguiente</strong>’ par continuar.</p>
<p style="text-align: center;"><img src="labRadius-015.png" alt="" width="741" height="598" /></p>
<p style="text-align: justify;">En la pantalla ‘<strong>Configurar métodos de autenticación’</strong> → Pulsamos ‘<strong>Agregar</strong>’ y seleccionamos el protocolo ‘<strong>EAP-MSCHAP v2'</strong> y pulsamos '<strong>Aceptar</strong>'.</p>
<div class="cuadro-nota-centro-new">
<p align="justify">Generalmente cuando son puntos de acceso, se utiliza PEAP.</p>
</div>
<p style="text-align: justify;">La sección de '<em><strong>Métodos de autenticación menos seguros</strong></em>' lo dejamos seleccionado tal como está en la imagen inferior.</p>
<p style="text-align: center;"><img src="labRadius-016.png" alt="" width="740" height="597" /></p>
<p style="text-align: justify;">En un caso real, si se desea securizar lo máximo posible habría que deseleccionar los '<em><strong>Métodos de autenticación menos seguros</strong></em> 'para que no se puedan utilizar. Para este caso de estudio, los dejaremos tal como están.</p>
<p style="text-align: justify;">A continuación, pulsamos ‘<strong>Siguiente</strong>’ para continuar.</p>
<p style="text-align: justify;">En la pantalla ‘<strong>Configurar restricciones</strong>’,  lo dejamos todo igual, aunque según los requerimientos que se tengan, se podrían configurar restricciones de horario, etc..</p>
<p style="text-align: center;"><img src="labRadius-017.png" alt="" width="741" height="600" /></p>
<p style="text-align: justify;">A continuación, pulsamos ‘<strong>Siguiente</strong>’ para continuar. En la pantalla '<strong>Configurar opciones</strong>’, lo dejamos todo igual.</p>
<p style="text-align: center;"><img src="labRadius-018.png" alt="" width="741" height="599" /></p>
<p style="text-align: justify;">A continuación, pulsamos ‘<strong>Siguiente</strong>’ para continuar. Aparece una nueva pantalla con el resumen de las configuraciones realizadas, donde podremos comprobar que todo está correcto. Para finalizar el proceso, pulsamos '<strong>Finalizar</strong>'.</p>
<p style="text-align: center;"><img src="labRadius-019.png" alt="" width="741" height="600" /></p>
<p style="text-align: justify;">Con esto ya tenemos configurado nuestro servidor Radius. Nos faltaría configurar nuestro Firewall para permitir las conexiones remotas, para ello, accedemos al Firewall de Windows.</p>
<p style="text-align: justify;">Dentro de '<strong>Configuración</strong>', seleccionamos ‘<strong>Centro de redes y recursos compartidos</strong>’ (ver imagen inferior).</p>
<p style="text-align: center;"><img src="labRadius-020.png" alt="" width="339" height="415" /></p>
<p style="text-align: justify;"><span style="font-size: 1em;">A continuación, seleccionamos ‘</span><strong style="font-size: 1em;">Firewall de Windows Defender</strong><span style="font-size: 1em;">’ (figura inferior).</span></p>
<p style="text-align: center;"><img src="labRadius-021.png" alt="" width="845" height="437" /></p>
<p style="text-align: justify;">Nos aparecerá la siguiente pantalla (ver imagen inferior), donde hay que pulsar el enlace '<strong>Configuración Avanzada</strong>' para poder abrir el puerto para hacer la conexión.</p>
<p style="text-align: center;"><img src="labRadius-022.png" alt="" width="969" height="544" /></p>
<p style="text-align: justify;">Hay que acceder al nodo '<strong>Reglas de entrada</strong>' para crear una nueva.</p>
<p style="text-align: center;"><img src="labRadius-023.png" alt="" width="1046" height="622" /></p>
<p style="text-align: justify;">En la nueva ventana, hay que seleccionar el option ‘<strong>Puerto</strong>’ y pulsar ‘<strong>Siguiente</strong>’ (ver imagen inferior).</p>
<p style="text-align: center;"><img src="labRadius-024.png" alt="" width="712" height="579" /></p>
<p style="text-align: justify;"><strong>Radius</strong> utiliza varios puertos. Para la autenticación utiliza el <strong>1812 UDP</strong>, por lo que hay que introducir el puerto 1812 UDP  y pulsar ‘<strong>Siguiente</strong>’.</p>
<p style="text-align: center;"><img src="labRadius-025.png" alt="" width="538" height="469" /></p>
<p style="text-align: justify;">En la siguiente pantalla, hay que seleccionar ‘<strong>Permitir la conexión</strong>’ y pulsar ‘<strong>Siguiente</strong>’.</p>
<p style="text-align: center;"><img src="labRadius-026.png" alt="" width="530" height="470" /></p>
<p style="text-align: justify;">En la siguiente pantalla, aplicamos la regla a todo: Dominio, Privado y Público .</p>
<p style="text-align: center;"><img src="labRadius-027.png" alt="" width="531" height="463" /></p>
<p style="text-align: justify;"><br />Para finalizar, ponemos un nombre descriptivo y pulsamos ‘<strong>Finalizar</strong>’.</p>
<p style="text-align: center;"><img src="labRadius-028.png" alt="" width="696" height="566" /></p>
<p style="text-align: justify;">Con esto, ya se tiene montado el <strong><em>servidor RADIUS</em></strong>. Para probar la conexión usamos una máquina virtual o el anfitrión/host que esté en el mismo segmento de red que el servidor RADIUS.</p>
<p style="text-align: justify;">Para este caso de estudio, se utiliza un equipo <strong><em>ubuntu server 20.0</em></strong>4 donde hay que instalarle la utilidad <em><strong>freeradius-utils.</strong></em></p>
<pre><span style="font-size: 12pt;"><strong>#</strong>apt install freeradius-utils</span></pre>
<p style="text-align: justify;">A continuación, hay que añadir en el fichero hosts que está ubicado en /etc/hosts, el nombre del equipo con su ip.</p>
<p style="text-align: center;"><img src="labRadius-029.png" alt="" width="502" height="167" /></p>
<p style="text-align: justify;">A continuación, hacemos una prueba con el paquete instalado:</p>
<pre><span style="font-size: 12pt;"><strong>#</strong>radtest -x -t mschap radiustest password123456. 192.168.1.124 1812 CcliRadius</span></pre>
<p style="text-align: justify;">Los parámetros que deberemos pasar a radtest son:</p>
<ul>
<li style="text-align: justify;"><strong>usuario</strong>: Usuario que queremos comprobar contra el servidor RADIUS ( radiustest).</li>
<li style="text-align: justify;"><strong>contraseña</strong>: La contraseña del usuario, para este caso de estudio es: password123456.</li>
<li style="text-align: justify;"><strong>radius-server</strong>: IP o nombre del servidor, para este caso de estudio es: 192.168.1.124</li>
<li style="text-align: justify;"><strong>puerto UDP</strong>: 1812.</li>
<li><strong>secret</strong>: Contraseña compartida (Secreto compartido ) con el servidor RADIUS para realizar consultas (CcliRadius).</li>
</ul>
<p>Antes de ejecutar el comando, hay que asegurarse que los servicios están iniciados, para ello, realizamos lo siguiente:</p>
<ul>
<li><strong>Acceder a nps.msc</strong>→ Autorizamos al servidor NPS para usar Active Directory en la autenticación de usuarios y grupos. Se hace con clic derecho en NPS y luego registramos el servidor. Además, esto permite el control de usuarios a través de las propiedades de marcado.</li>
</ul>
<p style="text-align: center;"><img src="labRadius-030.png" alt="" width="1050" height="328" /></p>
<h3 style="text-align: justify;">3. Referencias</h3>
<ul>
<li><span style="font-size: 12pt;"><a href="https://docs.microsoft.com/es-es/windows-server/networking/technologies/nps/nps-plan-server">https://docs.microsoft.com/es-es/windows-server/networking/technologies/nps/nps-plan-server</a></span></li>
<li><span style="font-size: 12pt;"><a href="https://iescelia.org/ciberseguridad/configuracion-de-radius-en-windows-server-2019/">https://iescelia.org/ciberseguridad/configuracion-de-radius-en-windows-server-2019/</a></span></li>
<li><span style="font-size: 12pt;"><a href="https://techexpert.tips/es/apache-es/apache-autenticacion-radius-en-active-directory/">https://techexpert.tips/es/apache-es/apache-autenticacion-radius-en-active-directory/</a></span></li>
<li><span style="font-size: 12pt;"><a href="https://social.technet.microsoft.com/Forums/es-ES/0ba9b0f4-686f-49b8-ab6c-a7e435e5548a/ver-usuarios-conectados-a-traves-de-mi-server-radius?forum=wsnies">https://social.technet.microsoft.com/Forums/es-ES/0ba9b0f4-686f-49b8-ab6c-a7e435e5548a/ver-usuarios-conectados-a-traves-de-mi-server-radius?forum=wsnies</a></span></li>
<li><span style="font-size: 12pt;"><a href="https://red-orbita.com/?p=8015" target="_blank" rel="noopener">Autenticación en Active Directory vía RADIUS GNU/Linux</a></span></li>
<li><span style="font-size: 12pt;"><a href="http://systemadmin.es/2011/08/hacer-una-query-contra-un-radius-desde-command-line">http://systemadmin.es/2011/08/hacer-una-query-contra-un-radius-desde-command-line</a></span></li>
<li><span style="font-size: 12pt;"><a href="https://docs.microsoft.com/es-es/windows-server/remote/remote-access/ras/otp/plan/step-2-plan-the-radius-server-deployment">https://docs.microsoft.com/es-es/windows-server/remote/remote-access/ras/otp/plan/step-2-plan-the-radius-server-deployment</a></span><span style="font-size: 12pt;"></span></li>
</ul>
<div style="position: static !important;"></div></div>
</div>
</div>
</div>
</div>
</div>
<div id="packageLicense" class="cc cc-by-nc-sa">
<p><span>Obra publicada con</span> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Licencia Creative Commons Reconocimiento No comercial Compartir igual 4.0</a></p>
</div>
</div>
</div>
<div id='bottomPagination'>
<div class="pagination noprt">
<a href="2_instalacin_cliente_radius.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="11_ldap.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</div>
</div>
</div>
<script type="text/javascript" src="_style_js.js"></script></body></html>