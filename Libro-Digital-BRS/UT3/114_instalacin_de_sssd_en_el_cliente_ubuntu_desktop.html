<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="es" xml:lang="es" xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>11.4 Instalación de SSSD en el cliente Ubuntu Desktop | UT3. Sistemas de control de acceso y credenciales </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta http-equiv="content-language" content="es" />
<meta name="author" content="Juan Carlos Requena" />
<link rel="license" type="text/html" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" />
<meta name="generator" content="eXeLearning 2.7 - exelearning.net" />
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body class="exe-web-site" id="exe-node-111"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Saltar la navegación</a></p>
<div id="header"  style="background-image: url(logoJCRequena.png); background-repeat: no-repeat;"><div id="headerContent">UT3. Sistemas de control de acceso y credenciales</div></div>
<div id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">UT3. Sistemas de control de acceso y credenciales</a></li>
   <li><a href="objetivos.html" class="no-ch">Objetivos</a></li>
   <li><a href="recomendaciones_de_estudio__resumen.html" class="no-ch">Recomendaciones de estudio - Resumen</a></li>
   <li><a href="1_mecanismos_de_autenticacin_tipos_de_factores.html" class="daddy">1. Mecanismos de autenticación. Tipos de factores.</a>
   <ul class="other-section">
      <li><a href="11_mltiples_factores_de_autenticacin.html" class="no-ch">1.1 Múltiples factores de autenticación</a></li>
      <li><a href="tarea_1_autenticacin_de_doble_factor_por_ssh_con_google_authenticator.html" class="no-ch">Tarea 1. Autenticación de doble factor por SSH con Google Authenticator</a></li>
      <li><a href="laboratorio_1_autenticacin_multifactor_con_yubico.html" class="no-ch">Laboratorio 1. Autenticación multifactor con Yubico</a></li>
      <li><a href="tarea_2_ubuntu__2fa_para_login_con_yubico_security_key.html" class="no-ch">Tarea 2. Ubuntu - 2FA para login con Yubico Security Key</a></li>
   </ul>
   </li>
   <li><a href="2_tcnicas_de_autenticacin.html" class="no-ch">2. Técnicas de autenticación</a></li>
   <li><a href="3_gestin_de_credenciales.html" class="daddy">3. Gestión de credenciales</a>
   <ul class="other-section">
      <li><a href="31_lastpass.html" class="no-ch">3.1 LastPass</a></li>
      <li><a href="32_keepass.html" class="no-ch">3.2 Keepass</a></li>
      <li><a href="33_otros_gestores_de_contraseas.html" class="no-ch">3.3 Otros gestores de contraseñas</a></li>
      <li><a href="tarea_3_instalacin_configuracin_y_puesta_en_produccin_de_un_gestor_de_credenciales.html" class="no-ch">Tarea 3. Instalación, configuración y puesta en producción de un gestor de credenciales</a></li>
      <li><a href="34_brechas_de_seguridad_y_contraseas_inseguras.html" class="no-ch">3.4 Brechas de seguridad y contraseñas inseguras</a></li>
   </ul>
   </li>
   <li><a href="4_acceso_por_medio_de_firma_electrnica.html" class="daddy">4. Acceso por medio de firma electrónica</a>
   <ul class="other-section">
      <li><a href="41_lectores_de_dnie.html" class="no-ch">4.1 Lectores de DNIe</a></li>
      <li><a href="42_uso_de_nfc_con_el_dnie.html" class="no-ch">4.2 Uso de NFC con el DNIe</a></li>
   </ul>
   </li>
   <li><a href="5_sistemas_de_single_sign_on_sso.html" class="daddy">5. Sistemas de Single Sign On SSO</a>
   <ul class="other-section">
      <li><a href="tarea_4_sistemas_sso.html" class="no-ch">Tarea 4. Sistemas SSO</a></li>
   </ul>
   </li>
   <li><a href="6_criptografa.html" class="daddy">6. Criptografía</a>
   <ul class="other-section">
      <li><a href="61_aplicacin_de_la_criptografa_en_la_seguridad_de_la_informacin.html" class="daddy">6.1 Aplicación de la Criptografía en la seguridad de la información</a>
      <ul class="other-section">
         <li><a href="611_principios_bsicos_de_la_criptografa.html" class="no-ch">6.1.1 Principios básicos de la criptografía</a></li>
         <li><a href="612_criptografa_clsica.html" class="no-ch">6.1.2 Criptografía clásica</a></li>
         <li><a href="613_servicios_de_seguridad_de_criptografa.html" class="no-ch">6.1.3 Servicios de seguridad de criptografía</a></li>
         <li><a href="614_criptografa_moderna.html" class="daddy">6.1.4 Criptografía Moderna</a>
         <ul class="other-section">
            <li><a href="6141_criptografa_de_clave_privada.html" class="daddy">6.1.4.1 Criptografía de clave privada</a>
            <ul class="other-section">
               <li><a href="laboratorio_1_cifrado_simtrico_de_archivos.html" class="no-ch">Laboratorio 1. Cifrado simétrico de archivos</a></li>
               <li><a href="prctica_1_cifrado_simtrico.html" class="no-ch">Práctica 1. Cifrado simétrico</a></li>
            </ul>
            </li>
            <li><a href="6142_criptografa_de_clave_pblica.html" class="daddy">6.1.4.2 Criptografía de clave pública</a>
            <ul class="other-section">
               <li><a href="laboratorio_2_cifrado_asimtrico_de_ficheros.html" class="no-ch">Laboratorio 2. Cifrado asimétrico de ficheros</a></li>
               <li><a href="prctica_2cifrado_asimtrico.html" class="no-ch">Práctica 2.Cifrado Asimétrico</a></li>
            </ul>
            </li>
            <li><a href="6143_ventas_y_desventajas_cifrado_simtrico_y_asimetrico.html" class="no-ch">6.1.4.3 Ventas y desventajas cifrado simétrico y asimetrico</a></li>
            <li><a href="6144_criptografa_hbirida.html" class="no-ch">6.1.4.4 Criptografía híbirida</a></li>
         </ul>
         </li>
         <li><a href="615_esteganografa.html" class="daddy">6.1.5 Esteganografía</a>
         <ul class="other-section">
            <li><a href="tarea_5_openstego.html" class="no-ch">Tarea 5. OpenStego</a></li>
         </ul>
         </li>
         <li><a href="616_funciones_hash.html" class="daddy">6.1.6 Funciones hash</a>
         <ul class="other-section">
            <li><a href="tarea_6_funciones_hash.html" class="no-ch">Tarea 6. Funciones hash</a></li>
            <li><a href="tarea_7_quickhash.html" class="no-ch">Tarea 7. QuickHash</a></li>
            <li><a href="tarea_8_funciones_avanzadas_hash_de_powershell.html" class="no-ch">Tarea 8. Funciones avanzadas hash de powershell</a></li>
            <li><a href="laboratorio_3_funciones_hash_con_kleopatra.html" class="no-ch">Laboratorio 3. Funciones hash con Kleopatra</a></li>
         </ul>
         </li>
         <li><a href="617_uso_de_tcnicas_criptogrficas_en_las_pyme.html" class="no-ch">6.1.7 Uso de técnicas criptográficas en las PYME</a></li>
         <li><a href="618_sistemas_encriptacin_hardware_tpmhsm.html" class="no-ch">6.1.8 Sistemas encriptación hardware (TPM/HSM)</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="7_sistemas_de_control_de_acceso_y_autenticacin.html" class="daddy">7. Sistemas de control de acceso y autenticación</a>
   <ul class="other-section">
      <li><a href="71_creacin_de_claves_ssh.html" class="no-ch">7.1 Creación de claves SSH</a></li>
      <li><a href="72_certificados_digitales_gestin_de_una_pki.html" class="daddy">7.2. Certificados digitales, gestión de una PKI</a>
      <ul class="other-section">
         <li><a href="721_certificados_digitales.html" class="daddy">7.2.1 Certificados digitales</a>
         <ul class="other-section">
            <li><a href="laboratorio_4_certificado_personal.html" class="no-ch">Laboratorio 4. Certificado personal</a></li>
            <li><a href="tarea_9_verificacin_de_certificados_digitales.html" class="no-ch">Tarea 9. Verificación de certificados digitales</a></li>
         </ul>
         </li>
         <li><a href="722_firma_digital.html" class="daddy">7.2.2 Firma digital</a>
         <ul class="other-section">
            <li><a href="prctica_3_verificacin_de_la_autenticidad_e_integridad_de_un_mensaje.html" class="no-ch">Práctica 3: Verificación de la autenticidad e integridad de un mensaje</a></li>
         </ul>
         </li>
         <li><a href="723_infraestructuras_de_clave_pblica_pki.html" class="no-ch">7.2.3 Infraestructuras de clave pública (PKI)</a></li>
         <li><a href="laboratorio_5_infraestructura_de_clave_pblica_propia_con_openssl.html" class="no-ch">Laboratorio 5. Infraestructura de clave pública propia con OpenSSL</a></li>
         <li><a href="caso_prctico_uso_de_certificados_en_servicios_web.html" class="no-ch">Caso Práctico. Uso de certificados en Servicios WEB</a></li>
         <li><a href="reto_implementacin_de_una_sistema_de_certificados_pki_en_la_organizacin_con_easyrsa.html" class="no-ch">Reto. Implementación de una sistema de certificados (PKI) en la organización con Easy-RSA</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="8_gestin_de_accesos_sistemas_nac.html" class="daddy">8. Gestión de accesos. Sistemas NAC</a>
   <ul class="other-section">
      <li><a href="laboratorio_6_packetfence.html" class="no-ch">Laboratorio 6. PacketFence</a></li>
      <li><a href="prctica_4_acceso_a_la_web_a_travs_de_un_nac.html" class="no-ch">Práctica 4. Acceso a la web a través de un NAC</a></li>
   </ul>
   </li>
   <li><a href="9_gestin_de_cuentas_privilegiadas.html" class="daddy">9. Gestión de cuentas privilegiadas</a>
   <ul class="other-section">
      <li><a href="101_pam.html" class="no-ch">10.1 PAM</a></li>
      <li><a href="tarea_10_ejecutar_como.html" class="no-ch">Tarea 10. Ejecutar como</a></li>
   </ul>
   </li>
   <li><a href="10_protocolos_radius_y_tacacs_servicio_kerberos.html" class="daddy">10. Protocolos RADIUS y TACACS, servicio KERBEROS</a>
   <ul class="other-section">
      <li><a href="laboratorio_7_freeradius.html" class="daddy">Laboratorio 7. freeRadius</a>
      <ul class="other-section">
         <li><a href="1_instalacin_servidor_radius.html" class="no-ch">1. Instalación servidor Radius</a></li>
         <li><a href="2_instalacin_cliente_radius.html" class="no-ch">2. Instalación Cliente Radius</a></li>
      </ul>
      </li>
      <li><a href="laboratorio_8_radius_windows_server.html" class="no-ch">Laboratorio 8. Radius Windows Server</a></li>
   </ul>
   </li>
   <li class="current-page-parent"><a href="11_ldap.html" class="current-page-parent daddy">11. LDAP</a>
   <ul>
      <li><a href="111_instalacin_y_configuracin_de_ldap.html" class="no-ch">11.1 Instalación y configuración de LDAP.</a></li>
      <li><a href="112_configuracin_de_certificados_ssltsl_en_ldap.html" class="no-ch">11.2 Configuración de certificados SSL/TSL en LDAP.</a></li>
      <li><a href="113_creacin_de_cuentas_ldap.html" class="no-ch">11.3 Creación de cuentas LDAP</a></li>
      <li id="active"><a href="114_instalacin_de_sssd_en_el_cliente_ubuntu_desktop.html" class="active no-ch">11.4 Instalación de SSSD en el cliente Ubuntu Desktop</a></li>
      <li><a href="proyecto_instalar_servidor_de_autenticacin_openldap_servidor_ubuntu.html" class="no-ch">Proyecto. Instalar servidor de autenticación OpenLdap Servidor Ubuntu</a></li>
   </ul>
   </li>
   <li><a href="12_referencias.html" class="no-ch">12. Referencias</a></li>
</ul>
</div>
<div id='topPagination'>
<div class="pagination noprt">
<a href="113_creacin_de_cuentas_ldap.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="proyecto_instalar_servidor_de_autenticacin_openldap_servidor_ubuntu.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</div>
</div>
<div id="main-wrapper">
<div id="main"><a name="main"></a>
<div id="nodeDecoration"><h1 id="nodeTitle">11.4 Instalación de SSSD en el cliente Ubuntu Desktop</h1></div>
<div class="iDevice_wrapper textIdevice" id="id159">
<div class="iDevice emphasis0" >
<div id="ta159_159_2" class="block iDevice_content">
<div class="exe-text"><h3>1. Recursos</h3>
<p>En este apartado, hay que tener disponible una máquina virtual con Ubuntu Desktop 20.04/22.04 en la misma red que el servidor openldap.</p>
<h3>2. Instalación de SSSD</h3>
<p style="text-align: justify;"><strong>SSSD</strong> solo funciona si estamos utilizando un canal seguro de comunicación (TLS).</p>
<p style="text-align: justify;">Antes de iniciar la instalación en el equipo cliente, vamos a configurar nuestro archivo <strong>/etc/hosts</strong> para que sea capaz de encontrar el servidor LDAP. Para ello, se va a insertar la siguiente línea que contiene la ip del servidor y el nombre del dominio.</p>
<p><strong>192.168.0.25 ciber.local</strong></p>
<pre><span style="font-size: 12pt;"><strong>root@goofy:/home/jcrequena#</strong> nano /etc/hosts </span></pre>
<p style="text-align: center;"><img src="ldap-53.png" alt="" width="538" height="206" /></p>
<p>Instalamos los paquetes necesarios en el cliente Ubuntu.</p>
<pre><span style="font-size: 12pt;"><strong>root@goofy:/home/jcrequena#</strong> apt install sssd libpam-sss libnss-sss</span></pre>
<p style="text-align: center;"><img src="ldap-54.png" width="976" height="445" /></p>
<p> Por defecto SSSD no viene con ningún archivo de configuración, por lo que lo crearemos uno nuevo:</p>
<pre><span style="font-size: 12pt;"><strong>root@goofy:/home/jcrequena#</strong> nano /etc/sssd/sssd.conf</span></pre>
<p>Y agregamos las siguientes líneas:</p>
<pre><strong><span style="font-size: 12pt;">[sssd]</span></strong><br /><span style="font-size: 12pt;">services = nss, pam</span><br /><span style="font-size: 12pt;">config_file_version = 2</span><br /><span style="font-size: 12pt;">domains = default<br /></span><br /><span style="font-size: 12pt;"><strong>[nss]</strong><br /></span><br /><strong><span style="font-size: 12pt;">[pam]</span></strong><br /><span style="font-size: 12pt;">offline_credentials_expiration = 60<br /></span><br /><strong><span style="font-size: 12pt;">[domain/default]</span></strong><br /><span style="font-size: 12pt;">ldap_id_use_start_tls = True</span><br /><span style="font-size: 12pt;">cache_credentials = True</span><br /><span style="font-size: 12pt;">ldap_search_base = dc=<strong>ciber</strong>,dc=local</span><br /><span style="font-size: 12pt;">id_provider = ldap</span><br /><span style="font-size: 12pt;">auth_provider = ldap</span><br /><span style="font-size: 12pt;">chpass_provider = ldap</span><br /><span style="font-size: 12pt;">access_provider = ldap</span><br /><span style="font-size: 12pt;">ldap_uri = ldap://<strong>ciber</strong>.local</span><br /><span style="font-size: 12pt;">ldap_default_bind_dn = cn=readonly ,ou=usuarios,dc=<strong>ciber</strong>,dc=local</span><br /><span style="font-size: 12pt;">ldap_default_authtok = p4ssw0rd</span><br /><span style="font-size: 12pt;">ldap_tls_reqcert = demand</span><br /><span style="font-size: 12pt;">ldap_tls_cacert = /etc/ssl/certs/ldapcacert.crt</span><br /><span style="font-size: 12pt;">ldap_tls_cacertdir = /etc/ssl/certs</span><br /><span style="font-size: 12pt;">ldap_search_timeout = 50</span><br /><span style="font-size: 12pt;">ldap_network_timeout = 60</span><br /><span style="font-size: 12pt;">ldap_access_order = filter</span><br /><span style="font-size: 12pt;">ldap_access_filter = (objectClass=posixAccount)</span></pre>
<p><span>Guardamos:</span><strong><span> </span>CTRL + O</strong><span> y salimos: </span><strong>CTRL + X.</strong></p>
<p style="text-align: center;"><img src="ldap-55.png" width="655" height="535" /></p>
<p>A continuación, hay que descargar el <strong>certificado de la CA</strong> necesario para poder conectarnos al servidor OpenLDAP:</p>
<pre><span style="font-size: 12pt;"><strong>root@goofy:/home/jcrequena#</strong> openssl s_client -connect <strong>ciber.local</strong>:389 -starttls ldap -showcerts &lt; /dev/null | openssl x509 -text | sed -ne '/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p'</span></pre>
<p style="text-align: center;"><img src="ldap-56.png" width="861" height="689" /></p>
<pre><br /><span style="font-size: 10pt;">-----BEGIN CERTIFICATE-----</span><br /><span style="font-size: 10pt;">MIID+DCCAuCgAwIBAgICEAEwDQYJKoZIhvcNAQELBQAwgYoxCzAJBgNVBAYTAkVT</span><br /><span style="font-size: 10pt;">MRIwEAYDVQQIDAlDYXN0ZWxsb24xEjAQBgNVBAcMCUNhc3RlbGxvbjEOMAwGA1UE</span><br /><span style="font-size: 10pt;">CgwFY2liZXIxCzAJBgNVBAsMAklUMRQwEgYDVQQDDAtjaWJlci5sb2NhbDEgMB4G</span><br /><span style="font-size: 10pt;">CSqGSIb3DQEJARYRYWRtaW5AY2liZXIubG9jYWwwHhcNMjIwOTI3MDcwMzM3WhcN</span><br /><span style="font-size: 10pt;">MjMwOTI3MDcwMzM3WjB2MQswCQYDVQQGEwJFUzESMBAGA1UECAwJQ2FzdGVsbG9u</span><br /><span style="font-size: 10pt;">MQ4wDAYDVQQKDAVjaWJlcjELMAkGA1UECwwCSVQxFDASBgNVBAMMC2NpYmVyLmxv</span><br /><span style="font-size: 10pt;">Y2FsMSAwHgYJKoZIhvcNAQkBFhFhZG1pbkBjaWJlci5sb2NhbDCCASIwDQYJKoZI</span><br /><span style="font-size: 10pt;">hvcNAQEBBQADggEPADCCAQoCggEBAOWWU/7QRZz0izHKiVMGrP7eTO7Plpa9iyfz</span><br /><span style="font-size: 10pt;">Ki7xdlz5GjWBLVDp06xFGG/gEqQs5MIdQVUIfyF5YV41tKBZFw59rRgZGzsbSWme</span><br /><span style="font-size: 10pt;">+FGapp0HutNyu5MbnQONmhhXX9u3kjYybAVCrp/r7AnPxWhnapVi++smEG6WC3Z1</span><br /><span style="font-size: 10pt;">Y5AVWcT9F/Jr4e/AgqLJ3Vii53zG/2J0dlPfNhBNfmp2nUZxT8pc/cPj6B/8vmgK</span><br /><span style="font-size: 10pt;">uu4RyaXstwkQ3ROOnEI/tJmjWDBvp3wwNUYIlfVeySQhC8KczCxF5Inb0kzJrX8E</span><br /><span style="font-size: 10pt;">M4Dneiun9S6Bf3TZcv40qTYAlf3uzryw8cFYCjxhkZcVUmrnRb8CAwEAAaN7MHkw</span><br /><span style="font-size: 10pt;">CQYDVR0TBAIwADAsBglghkgBhvhCAQ0EHxYdT3BlblNTTCBHZW5lcmF0ZWQgQ2Vy</span><br /><span style="font-size: 10pt;">dGlmaWNhdGUwHQYDVR0OBBYEFEl2N6/G7X3LqVaI6KOqs0rAP2jcMB8GA1UdIwQY</span><br /><span style="font-size: 10pt;">MBaAFEMcs0z0PCbindhbTJWOgJ8+KTtLMA0GCSqGSIb3DQEBCwUAA4IBAQAyhIPR</span><br /><span style="font-size: 10pt;">Aax+9xClv1bp0PpFJoTiDfGWuFwgpeBbmwQhIHQEwRJ6HPtcjLDkufLI0DTn725Q</span><br /><span style="font-size: 10pt;">lxcW4LTLQFTNWTA/qONWFaw5RcNGk9Wj6qb37FMFgiY9szEPGFUEvJ0H6wC2Eo89</span><br /><span style="font-size: 10pt;">MHJcnpa41jflSPDdjqw2nrOrMuiTMLAHkqQCvN3FUHQuolrKmucVjDO7GCbYj0pS</span><br /><span style="font-size: 10pt;">E2RGlMq28D2x6yYDVWdm7WkbCyovDtOVu4GTrjbbtsZIFMLYyP4+AYN1JLDYDitu</span><br /><span style="font-size: 10pt;">Tk1JQtNfPeyRtHGYzjUaReNH1Ak0giu8SHpDJ2Yp8rIOj/RMJUAE2tfl/aGZGO5e</span><br /><span style="font-size: 10pt;">hcL5OHY0EHqzPYGi</span><br /><span style="font-size: 10pt;">-----END CERTIFICATE-----</span><br /><br /></pre>
<p>A continuación, hay que copiar el certificado y lo pegamos en la siguiente ubicación<span> </span><strong>/etc/ssl/certs/ldapcacert.crt.</strong></p>
<pre><span style="font-size: 12pt;"><strong>root@goofy:/home/jcrequena#</strong> nano /etc/ssl/certs/ldapcacert.crt</span></pre>
<p style="text-align: center;"><img src="ldap-57.png" width="596" height="467" /><span style="font-size: 12pt;"></span></p>
<p>Guardamos y verificamos que el certificado es válido:</p>
<pre><span style="font-size: 12pt;"><strong>root@goofy:/home/jcrequena#</strong> openssl s_client -connect ciber.local:389 -CAfile /etc/ssl/certs/ldapcacert.crt</span></pre>
<p style="text-align: center;"><span style="font-size: 12pt;"><img src="ldap-58.png" width="974" height="375" /></span></p>
<p>Al final vemos que nos devuelve<span> </span><strong>Verify return code: 0 (ok)</strong><span> </span>por lo que es válido.</p>
<p>Ahora modificaremos el archivo<span> </span><strong>/etc/ldap/ldap.conf<span> </span></strong>para que apunte al certificado que hemos añadido al equipo:</p>
<pre><span style="font-size: 12pt;"><strong>root@goofy:/home/jcrequena#</strong> nano /etc/ldap/ldap.conf</span></pre>
<p style="text-align: justify;">Para este caso, se comenta la línea TLS_CACERT y se añade la siguiente:</p>
<p style="text-align: justify;"><strong>TLS_CACERT /etc/ssl/certs/ldapcacert.crt</strong></p>
<p style="text-align: center;"><img src="ldap-59.png" width="630" height="349" /></p>
<p>Una vez modificado el fichero, guardamos.</p>
<p>Ahora daremos permisos adecuados a la carpeta<span> </span><strong>sssd.</strong></p>
<pre><span style="font-size: 12pt;"><strong>root@goofy:/home/jcrequena#</strong> chmod 600 -R /etc/sssd</span></pre>
<p>Reiniciamos el servicio y comprobamos el estado del servicio para comprobar que todo está en orden.</p>
<pre><span style="font-size: 12pt;"><strong>root@goofy:/home/jcrequena#</strong> systemctl restart sssd<br /><strong>root@goofy:/home/jcrequena#</strong> systemctl status sssd<br /></span></pre>
<p style="text-align: center;"><img src="ldap-60.png" width="874" height="384" /></p>
<p>Finalmente se habilita el servicio para que inicie al iniciarse el equipo:</p>
<pre><span style="font-size: 12pt;"><strong>root@goofy:/home/jcrequena#</strong> systemctl enable sssd</span></pre>
<p style="text-align: center;"><img src="ldap-61.png" width="905" height="84" /></p>
<h3>3. Configurar la creación automática del directorio Home</h3>
<p style="text-align: justify;">Para habilitar la creación automática del directorio de los usuarios en su primer inicio de sesión deberemos configurar los módulos de PAM. En primer lugar se modifica el archivo de configuración de PAM:</p>
<pre><span style="font-size: 12pt;"><strong>root@goofy:/home/jcrequena#</strong> nano /etc/pam.d/common-session</span></pre>
<p>En este archivo añadiremos la siguiente línea debajo de<span> </span><strong>pam_sss.so</strong></p>
<pre><span style="font-size: 12pt;"><strong>session required        pam_mkhomedir.so skel=/etc/skel/ umask=0022</strong></span></pre>
<p>Quedando de la siguiente forma:</p>
<p style="text-align: center;"><img src="ldap-62.png" alt="" width="786" height="365" /></p>
<h3>4. Verificar autenticación mediante SSD OpenLDAP</h3>
<p>Ya hemos terminado con la instalación y configuración de SSSD, ahora vamos a ver si podemos loguearnos en el cliente Ubuntu con el usuario que hemos creado antes.</p>
<p>Hemos creado un usuario antes, el cual podemos verlo desde el <strong>servidor ubuntu</strong> (openldap) mediante el siguiente comando:</p>
<pre><span style="font-size: 12pt;"><strong>root@orion:/home/administrador#</strong> ldapsearch -H ldapi:/// -Y EXTERNAL -b "ou=usuarios,dc=ciber,dc=local" dn -LLL -Q</span></pre>
<p style="text-align: center;"><strong><img src="ldap-63.png" alt="" width="909" height="154" /></strong></p>
<p> Para ello, deberemos reiniciar nuestro cliente Ubuntu Desktop. Una vez hecho, en la ventana de login vamos a <strong>¿No está en la lista?</strong></p>
<p style="text-align: center;"><img src="ldap-64.png" alt="" width="793" height="565" /></p>
<p>Y escribimos el usuario que hemos creado por ldap:</p>
<p style="text-align: center;"><img src="ldap-65.png" alt="" width="416" height="442" /></p>
<p>Ahora, dispondremos de un usuario creado mediante ldap en el servidor al que hemos podido acceder desde nuestro cliente.</p>
<p style="text-align: center;"><img src="ldap-66.png" alt="" width="1186" height="693" /></p></div>
</div>
</div>
</div>
<div id="packageLicense" class="cc cc-by-nc-sa">
<p><span>Obra publicada con</span> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Licencia Creative Commons Reconocimiento No comercial Compartir igual 4.0</a></p>
</div>
</div>
</div>
<div id='bottomPagination'>
<div class="pagination noprt">
<a href="113_creacin_de_cuentas_ldap.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="proyecto_instalar_servidor_de_autenticacin_openldap_servidor_ubuntu.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</div>
</div>
</div>
<script type="text/javascript" src="_style_js.js"></script></body></html>
