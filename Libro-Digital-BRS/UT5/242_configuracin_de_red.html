<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="es" xml:lang="es" xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>2.4.2 Configuración de red | UT5. Fortificación de equipos: Configuración de los sistemas informáticos </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta http-equiv="content-language" content="es" />
<meta name="author" content="Juan Carlos Requena" />
<link rel="license" type="text/html" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" />
<meta name="generator" content="eXeLearning 2.7 - exelearning.net" />
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body class="exe-web-site" id="exe-node-50"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Saltar la navegación</a></p>
<div id="header"  style="background-image: url(logoJCRequena.png); background-repeat: no-repeat;"><div id="headerContent">UT5. Fortificación de equipos: Configuración de los sistemas informáticos</div></div>
<div id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">UT5. Fortificación de equipos: Configuración de los sistemas informáticos</a></li>
   <li><a href="objetivos.html" class="no-ch">Objetivos</a></li>
   <li class="current-page-parent"><a href="2_hardening.html" class="current-page-parent daddy">2. Hardening</a>
   <ul>
      <li><a href="21_server_hardening.html" class="no-ch">2.1 Server Hardening</a></li>
      <li><a href="22_recomendaciones_generales_de_seguridad_en_servidores.html" class="no-ch">2.2 Recomendaciones generales de seguridad en servidores</a></li>
      <li><a href="23_defensa_en_profundidad.html" class="no-ch">2.3 Defensa en profundidad</a></li>
      <li><a href="24_hardening_windows.html" class="daddy">2.4 Hardening Windows</a>
      <ul class="other-section">
         <li><a href="241_windows_exploit_suggester.html" class="daddy">2.4.1 Windows Exploit Suggester</a>
         <ul class="other-section">
            <li><a href="proyecto_server_hardening_windows__realizar_una_auditora_en_el_servidor_windows.html" class="no-ch">Proyecto Server Hardening Windows - Realizar una auditoría en el servidor Windows</a></li>
         </ul>
         </li>
         <li><a href="242_reduccin_del_nmero_de_servicios.html" class="daddy">2.4.2 Reducción del número de servicios</a>
         <ul class="other-section">
            <li><a href="laboratorio_1_process_hacker.html" class="no-ch">Laboratorio 1. Process Hacker</a></li>
            <li><a href="laboratorio_2_uso_del_firewall_de_windows__configuracin_de_red.html" class="no-ch">Laboratorio 2. Uso del firewall de Windows - Configuración de red</a></li>
            <li><a href="proyecto_server_hardening_windows__seguridad_de_red_y_firewall.html" class="no-ch">Proyecto Server Hardening Windows - Seguridad de red y firewall</a></li>
         </ul>
         </li>
      </ul>
      </li>
      <li class="current-page-parent"><a href="25_hardening_linux__lynis.html" class="current-page-parent daddy">2.5 Hardening Linux - Lynis</a>
      <ul>
         <li><a href="proyecto_server_hardening_linux_auditora_de_sistemas_con_lynis.html" class="no-ch">Proyecto Server Hardening Linux. Auditoría de sistemas con Lynis</a></li>
         <li><a href="241_contraseas.html" class="no-ch">2.4.1 Contraseñas</a></li>
         <li id="active"><a href="242_configuracin_de_red.html" class="active no-ch">2.4.2 Configuración de red</a></li>
         <li><a href="243_cortafuegos_basados_en_host__configuracin_del_firewall_ufw.html" class="no-ch">2.4.3 Cortafuegos basados en host - Configuración del firewall ufw</a></li>
         <li><a href="laboratorio_3_uso_del_firewall_de_linux__iptables.html" class="no-ch">Laboratorio 3. Uso del firewall de Linux - Iptables</a></li>
         <li><a href="proyecto_server_hardening_linux_contraseas_red_y_firewall.html" class="no-ch">Proyecto Server Hardening Linux. Contraseñas, red y firewall</a></li>
      </ul>
      </li>
      <li><a href="26_hardening_apache.html" class="daddy">2.6 Hardening Apache</a>
      <ul class="other-section">
         <li><a href="proyecto_server_hardening_linux_apache.html" class="no-ch">Proyecto Server Hardening Linux. Apache</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="3_securizacin_de_los_sistemas_de_administracin_remota.html" class="daddy">3. Securización de los sistemas de administración remota</a>
   <ul class="other-section">
      <li><a href="31_secureshell.html" class="daddy">3.1 SecureShell</a>
      <ul class="other-section">
         <li><a href="311_aplicaciones_de_ssh.html" class="no-ch">3.1.1 Aplicaciones de SSH</a></li>
         <li><a href="312_instalacin_del_servidor_ssh.html" class="no-ch">3.1.2 Instalación del servidor SSH</a></li>
         <li><a href="313_secure_shell_para_administracin_remota_mediante_certificado.html" class="daddy">3.1.3 Secure Shell para administración remota mediante certificado</a>
         <ul class="other-section">
            <li><a href="tarea_1_ssh__acceso_remoto_desde_windows_10.html" class="no-ch">Tarea 1. SSH - Acceso remoto desde Windows 10</a></li>
         </ul>
         </li>
         <li><a href="314_anlisis_de_archivos_de_auditora.html" class="daddy">3.1.4 Análisis de archivos de auditoría</a>
         <ul class="other-section">
            <li><a href="laboratorio_4_instalacin_de_graylog.html" class="no-ch">Laboratorio 4. Instalación de Graylog</a></li>
         </ul>
         </li>
         <li><a href="315_fortificacin_de_ssh.html" class="no-ch">3.1.5 Fortificación de SSH</a></li>
         <li><a href="proyecto_server_hardening_linux_34_caso_prctico_fortificacin_ssh.html" class="no-ch">Proyecto Server Hardening Linux. 3.4 Caso práctico fortificación ssh</a></li>
         <li><a href="316_sshguard.html" class="daddy">3.1.6 SSHGuard</a>
         <ul class="other-section">
            <li><a href="proyecto_server_hardening_linux_sshguard.html" class="no-ch">Proyecto Server Hardening Linux. SSHGuard</a></li>
         </ul>
         </li>
      </ul>
      </li>
      <li><a href="32__rdpguard.html" class="daddy">3.2  RdpGuard</a>
      <ul class="other-section">
         <li><a href="proyecto_server_hardening_windows_rdpguard.html" class="no-ch">Proyecto Server Hardening Windows. RdpGuard</a></li>
      </ul>
      </li>
      <li><a href="33_fail2ban.html" class="daddy">3.3 Fail2Ban</a>
      <ul class="other-section">
         <li><a href="proyecto_server_hardening_linux__fail2ban.html" class="no-ch">Proyecto Server Hardening Linux - Fail2ban</a></li>
      </ul>
      </li>
      <li><a href="34_fwsnort.html" class="no-ch">3.4 Fwsnort</a></li>
      <li><a href="35_grsecurity.html" class="no-ch">3.5 Grsecurity</a></li>
   </ul>
   </li>
   <li><a href="4_sistemas_de_prevencin_y_proteccin_frente_a_virus_e_intrusiones.html" class="daddy">4. Sistemas de prevención y protección frente a virus e intrusiones</a>
   <ul class="other-section">
      <li><a href="41_antivirus.html" class="daddy">4.1. Antivirus</a>
      <ul class="other-section">
         <li><a href="411_virustotal.html" class="no-ch">4.1.1 VirusTotal</a></li>
      </ul>
      </li>
      <li><a href="42_antivirus_endpoint_detection__response_edr.html" class="daddy">4.2. Antivirus Endpoint Detection &amp; Response (EDR)</a>
      <ul class="other-section">
         <li><a href="421_ejemplo_de_una_solucin_antivirus_en_la_nube.html" class="daddy">4.2.1 Ejemplo de una solución antivirus en la nube</a>
         <ul class="other-section">
            <li><a href="4211_registro_y_creacin_del_espacio_de_trabajo.html" class="no-ch">4.2.1.1 Registro y creación del espacio de trabajo</a></li>
            <li><a href="4212_panel_de_informacin_configuracin_primeros_pasos.html" class="no-ch">4.2.1.2 Panel de Información. Configuración. Primeros pasos</a></li>
            <li><a href="4213_usuarios.html" class="no-ch">4.2.1.3 Usuarios</a></li>
            <li><a href="4214_dispositivos.html" class="no-ch">4.2.1.4 Dispositivos</a></li>
            <li><a href="4215_administrador_de_seguridad.html" class="no-ch">4.2.1.5 Administrador de Seguridad</a></li>
            <li><a href="4216_vulnerabilidades_parches_cifrado_y_certificados.html" class="no-ch">4.2.1.6 Vulnerabilidades, parches, cifrado y certificados</a></li>
            <li><a href="4217_nuevas_funcionalidades.html" class="no-ch">4.2.1.7 Nuevas funcionalidades</a></li>
            <li><a href="proyecto_server_hardening_windows_kaspersky.html" class="no-ch">Proyecto Server Hardening Windows. Kaspersky</a></li>
         </ul>
         </li>
      </ul>
      </li>
      <li><a href="43_host_ids.html" class="daddy">4.3. Host IDS</a>
      <ul class="other-section">
         <li><a href="proyecto_server_hardening_windows__ids_wazuh.html" class="no-ch">Proyecto Server Hardening Windows - IDS wazuh</a></li>
      </ul>
      </li>
      <li><a href="44_honeypot.html" class="no-ch">4.4. Honeypot</a></li>
   </ul>
   </li>
   <li><a href="5_configuracin_de_actualizaciones_y_parches_automticos.html" class="daddy">5. Configuración de actualizaciones y parches automáticos</a>
   <ul class="other-section">
      <li><a href="51_unattendedupgrades.html" class="no-ch">5.1 unattended-upgrades</a></li>
      <li><a href="52_wsus.html" class="daddy">5.2 WSUS</a>
      <ul class="other-section">
         <li><a href="faqserroreswsus.html" class="no-ch">FAQS-errores-WSUS</a></li>
         <li><a href="proyecto_server_hardening_windows_wsus.html" class="no-ch">Proyecto Server Hardening Windows. WSUS</a></li>
      </ul>
      </li>
   </ul>
   </li>
   <li><a href="6_sistemas_de_copias_de_seguridad.html" class="daddy">6. Sistemas de copias de seguridad</a>
   <ul class="other-section">
      <li><a href="61_herramientas.html" class="no-ch">6.1 Herramientas</a></li>
      <li><a href="62_copias_a_disco_duro.html" class="no-ch">6.2 Copias a disco duro</a></li>
      <li><a href="63_copias_a_unidad_en_drive.html" class="no-ch">6.3 Copias a unidad en Drive</a></li>
      <li><a href="64_gestin_de_backups_en_linux.html" class="no-ch">6.4 Gestión de backups en Linux</a></li>
      <li><a href="proyecto_server_hardening_en_linux_y_windows__copias_de_seguridad.html" class="no-ch">Proyecto Server Hardening en Linux y Windows - Copias de Seguridad</a></li>
   </ul>
   </li>
   <li><a href="7_soluciones_dlp.html" class="daddy">7. Soluciones DLP</a>
   <ul class="other-section">
      <li><a href="71_plataformas_dlp_en_el_mercado.html" class="no-ch">7.1 Plataformas DLP en el mercado</a></li>
   </ul>
   </li>
   <li><a href="8_referencias.html" class="no-ch">8. Referencias</a></li>
</ul>
</div>
<div id='topPagination'>
<div class="pagination noprt">
<a href="241_contraseas.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="243_cortafuegos_basados_en_host__configuracin_del_firewall_ufw.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</div>
</div>
<div id="main-wrapper">
<div id="main"><a name="main"></a>
<div id="nodeDecoration"><h1 id="nodeTitle">2.4.2 Configuración de red</h1></div>
<div class="iDevice_wrapper FreeTextIdevice" id="id85">
<div class="iDevice emphasis0">
<div id="ta85_85" class="block iDevice_content">
<h3>1. Seguridad de red</h3>
<p style="text-align: justify;">Es importante establecer unas<strong> políticas de seguridad a nivel de red</strong>, para ello hay que bloquear el redireccionamiento ICMP, IP forwarding y las respuestas ICMP Broadcast. De esta manera se evita que un atacante realice ataques '<strong>Man in the Middle'</strong>, y así evitar que pueda conseguir datos confidenciales.</p>
<p style="text-align: justify;">En los siguientes apartados, se proponen unas <strong>medidas de seguridad para la mejora de la capacidad del sistema para defenderse de ciertos tipos de ataques IP</strong>. Se deberá tener en cuenta que si el sistema debe funcionar pasando tráfico entre diferentes tarjetas, la configuración propuesta hará que deje de funcionar por lo que los parámetros de la sección “No permitir funcionamiento como router” no deberán aplicarse.</p>
<h4>1. Bloquear los paquetes ICMP</h4>
<p>Para bloquear los paquetes ICMP se utilizan los siguientes comandos:</p>
<pre><span><span style="font-size: 12pt;"><strong>administrador@orion:~$ </strong>sudo sysctl -w net.ipv4.conf.all.send_redirects=0</span><br /><span style="font-size: 12pt;"><strong>administrador@orion:~$ </strong>sudo sysctl -w net.ipv4.conf.default.send_redirects=0<strong></strong></span><br /><span style="font-size: 12pt;"><strong>administrador@orion:~$</strong> sudo sysctl -w net.ipv4.route.flush=1</span><br /></span></pre>
<p style="text-align: center;"><img src="seguridad-red-01.png" alt="" width="662" height="185" /></p>
<p style="text-align: justify;"><strong>Bloquear ICMPs maliciosos</strong></p>
<pre><span><span style="font-size: 12pt;"><strong>administrador@orion:~$ </strong>sudo sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1</span></span></pre>
<h4>2. Deshabilitar IP Forwarding - No permitir funcionamiento como router</h4>
<p style="text-align: justify;"><span><strong>IP Forwarding</strong>, es una vulnerabilidad que permite el reenvío de paquetes a través del host, por lo cual un atacante puede usar esta vulnerabilidad para evitar cortafuegos/enrutadores.</span></p>
<p>Para deshabilitar IP Forwarding, el comando es el siguiente:</p>
<pre><span><span style="font-size: 12pt;"><strong>administrador@orion:~$ </strong>sudo sysctl -w net.ipv4.ip_forward=0<br /><strong>administrador@orion:~$</strong> sudo sysctl -w net.ipv4.conf.all.send_redirects=0<br /><strong>administrador@orion:~$</strong> sudo sysctl -w net.ipv4.conf.default.send_redirects=0<br /></span></span></pre>
<p style="text-align: center;"><img src="conf-red-02.png" alt="" width="642" height="127" /></p>
<h4>3. Deshabilitar broadcast ICMP - Bloquear respuestas Broadcast</h4>
<p>Es necesario deshabilitar también el broadcast ICMP, de este modo se bloquean los intentos de un atacante si consigue modificar la IP origen por la de nuestro equipo. Los comandos son los siguientes:</p>
<pre><span><span style="font-size: 12pt;"><strong>administrador@orion:~$ </strong>sudo sysctl -w net.ipv4.icmp_echo_ignore_broadcasts=1<br /><strong>administrador@orion:~$ </strong>sudo sysctl -w net.ipv4.route.flush=1<br /></span></span></pre>
<p style="text-align: center;"><img src="conf-red-03.png" alt="" width="618" height="98" /></p>
<p>Además, hay que definir que registre solo aquellos paquetes que cumplan los estándares, para ello, se utilizan los siguientes comandos:</p>
<pre><span><span style="font-size: 12pt;"><strong>administrador@orion:~$ </strong>sudo sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1<br /><strong>administrador@orion:~$ </strong>sudo sysctl -w net.ipv4.route.flush=1</span></span></pre>
<p style="text-align: center;"><img src="conf-red-05.png" alt="" width="698" height="104" /></p>
<p>Para evitar el <strong>spoofing</strong>, es decir, para asegurar que el origen de los paquetes es el correcto, los comandos a utilizar son los siguientes:</p>
<pre><span><span style="font-size: 12pt;"><strong>administrador@orion:~$ </strong>sudo sysctl -w net.ipv4.conf.all.rp_filter=1<br /><strong>administrador@orion:~$ </strong>sudo sysctl -w net.ipv4.conf.default.rp_filter=1<br /><strong>administrador@orion:~$ </strong>sudo sysctl -w net.ipv4.route.flush=1<br /></span></span></pre>
<p style="text-align: center;"><img src="conf-red-06.png" alt="" width="616" height="129" /></p>
<p style="text-align: justify;">Otra opción de la que disponen los atacantes para realizar una denegación de servicio es el uso de conexiones sin terminar todo el <a href="https://es.wikipedia.org/wiki/Establecimiento_de_comunicaci%C3%B3n" target="_blank" rel="noopener">handshake</a>, de esta manera el servidor deja una cola de conexiones en espera, pudiendo llegar a realizar una denegación de servicio. Para evitarlo se pueden utilizar los siguientes comandos:<span><span style="font-size: 12pt;"><strong></strong></span></span></p>
<pre><span><span style="font-size: 12pt;"><strong>administrador@orion:~$ </strong>sudo sysctl -w net.ipv4.tcp_syncookies=1<br /><strong>administrador@orion:~$ </strong>sudo sysctl -w net.ipv4.route.flush=1</span></span></pre>
<p style="text-align: center;"><img src="conf-red-07.png" alt="" width="515" height="95" /></p>
<h4 style="text-align: justify;">4. No permitir la alteración de las tablas de rutas</h4>
<pre><span><span style="font-size: 12pt;"><strong>administrador@orion:~$ </strong>sudo sysctl -w net.ipv4.conf.all.accept_redirects=0<br /><strong>administrador@orion:~$ </strong>sudo sysctl -w net.ipv4.conf.default.accept_redirects=0<br /><strong>administrador@orion:~$ </strong>sudo sysctl -w net.ipv4.conf.all.secure_redirects=0<br /><strong>administrador@orion:~$ </strong>sudo sysctl -w net.ipv4.conf.default.secure_redirects=0<br /></span></span></pre>
<h4 style="text-align: justify;">5. No permitir los paquetes enrutados en origen</h4>
<pre><span><span style="font-size: 12pt;"><strong>administrador@orion:~$ </strong>sudo sysctl -w net.ipv4.conf.all.accept_source_route=0<br /><strong>administrador@orion:~$ </strong>sudo sysctl -w net.ipv4.conf.default.accept_source_route=0</span></span></pre>
<h4 style="text-align: justify;">6. Activar SYN Cookies</h4>
<p style="text-align: justify;"><span>Como <a href="https://docs.vmware.com/es/vRealize-Operations/8.4/com.vmware.vcom.core.doc/GUID-07AB31D9-8F7D-4FD8-B3D5-FFB064CFFC3E.html" target="_blank" rel="noopener"><strong>recomendación de seguridad</strong></a>, hay que acitvar en el sistema el uso de cookies SYN de TCP (protocolo de control de transmisión) IPv4. Un ataque de inundación SYN de TCP podría provocar una denegación de servicio al rellenar la tabla de conexiones TCP de un sistema con conexiones en estado SYN_RCVD. Las cookies SYN se utilizan para no realizar el seguimiento de una conexión hasta que se reciba la indicación ACK posterior, con lo que se verifica que el iniciador está intentando realizar una conexión válida y no es una fuente de inundación.</span></p>
<p style="text-align: justify;"><span>Esta técnica <strong>no cumple totalmente los estándares</strong>, pero solo <strong>se activa cuando se detecta una condición de inundación</strong> y permite la defensa del sistema mientras se sirven solicitudes válidas.</span></p>
<pre><span><span style="font-size: 12pt;"><strong>administrador@orion:~$ </strong>sudo sysctl -w net.ipv4.tcp_syncookies=1<br /></span></span></pre>
<h4 style="text-align: justify;">7. Habilitar reverse path filtering</h4>
<p>El '<strong>reverse path filtering</strong>' se utiliza para evitar que los paquetes que llegaron a través de una interfaz salgan a través de una interfaz diferente.</p>
<pre><span><span style="font-size: 12pt;"><strong>administrador@orion:~$ </strong>sudo sysctl -w net.ipv4.conf.all.rp_filter=1<br /><strong>administrador@orion:~$ </strong>sudo sysctl -w net.ipv4.conf.default.rp_filter=1</span></span></pre>
</div>
</div>
</div>
<div id="packageLicense" class="cc cc-by-nc-sa">
<p><span>Obra publicada con</span> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Licencia Creative Commons Reconocimiento No comercial Compartir igual 4.0</a></p>
</div>
</div>
</div>
<div id='bottomPagination'>
<div class="pagination noprt">
<a href="241_contraseas.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="243_cortafuegos_basados_en_host__configuracin_del_firewall_ufw.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</div>
</div>
</div>
<script type="text/javascript" src="_style_js.js"></script></body></html>